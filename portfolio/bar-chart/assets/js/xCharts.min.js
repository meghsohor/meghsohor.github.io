/**
 * xg-xcharts - charts base on d3.js
 * @version v0.3.2
 * @date 2018-08-09 21:58:57
*/
!function(t,e){"function"==typeof define&&define.amd?define("xCharts",["d3"],function(i){return t.xCharts=e(i)}):"object"==typeof exports?module.exports=e(require("d3")):t.xCharts=e(t.d3)}(this,function(t){function e(i){return t?new e.prototype.init(i):void console.error("The library depends on d3js http://d3js.org/ ")}function i(t,e,i){var n=getComputedStyle(t),r=n[e];return i?parseFloat(r):r}function n(t){var e=i(t,"width",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderLeftWidth",!0)-i(t,"paddingLeft",!0)-i(t,"paddingRight",!0)-i(t,"borderRightWidth",!0)}function r(t){var e=i(t,"height",!0);return"border-box"!==i(t,"boxSizing")?e:e=e-i(t,"borderTopWidth",!0)-i(t,"paddingTop",!0)-i(t,"paddingBottom",!0)-i(t,"borderBottomWidth",!0)}function a(t,e){var i={};e.getColor;t.forEach(function(t){var e=t.type;i[e]=void 0==i[e]?i[e]=[]:i[e],i[e].push(t)});for(var n in i)if(i.hasOwnProperty(n))switch(n){case"line":case"scatter":case"bar":i[n].forEach(function(t,e){t.idx=e});break;case"pie":case"funnel":case"radar":i[n].forEach(function(t){t.data.forEach(function(t,e){t.idx=e})});break;default:console.error("type=%d not supported")}}function o(t){var i=e.utils;this.config=i.copy(t,!0),this.getColor=i.getColor(t.color),this.config.animation&&this.config.animation.enable?this.config.animation=i.merage(i.copy(d),this.config.animation):(this.config.animation=i.copy(d),this.config.animation.animationTime=0),this.config.peekPoints&&this.config.peekPoints.enable||(this.config.peekPoints=i.copy(f)),this.config.animation.animationEase=i.stringToD3Ease(this.config.animation.animationEase)}function s(t){var e=t.attr("xcharts-id"),i=u[e];i.fire("chartRemoveBind"),delete u[e]}function l(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<e.length;n++)if(t.indexOf(e[n])>0){i=!1;break}return!i}var c=1,h=l();e.extend=e.prototype.extend=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])};var u={};e.prototype.extend({init:function(i){i=t.select(i);var a=i.select(".xc-container");a.node()&&s(a),i.html(""),this.mobileMode=h,this.container=i,this.originalWidth=n(i.node()),this.originalHeight=r(i.node()),this.id=c++,this.div=i.append("div").attr("class","xc-container"),this.svg=this.div.append("svg").attr("class","xc-svg").attr("width",this.originalWidth).attr("height",this.originalHeight),this.main=this.svg.append("g").attr("class","xc-main"),this.margin={top:15,left:10,right:15,bottom:30},this.originMargin=e.utils.copy(this.margin),this.EventList={};var o=Math.random().toString(36).substr(2);return this.div.attr("xcharts-id",o),u[o]=this,this},loadConfig:function(t){o.call(this,t),this.firstDrawing(this.config)},firstDrawing:function(t){var i,n=["title","tooltip","legend","brush","yAxis","xAxis","guides","resize"],r=0;for(this.components={},this.charts={},t.series||(t.series=[],console.error("series is required in configuration"));i=n[r++];)if(t[i]&&!this.components[i]){var o=e.components[i];"xAxis"!=i&&"yAxis"!=i||(o=e.components.axis),o?this.components[i]=new o(this,t,i):console.warn("components/%s.js is not loaded!",i.match(/Axis/)?"axis":i)}a(t.series,this),this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.main.attr("transform","translate("+this.margin.left+","+this.margin.top+")");for(var s,r=0;s=t.series[r++];){var l=s.type;if(!this.charts[l]){var c=e.charts[l];c?this.charts[l]=new c(this,t):console.warn("charts/%s.js is not loaded!",l)}}},refresh:function(t,i){try{if(this.originalWidth=n(this.container.node()),this.originalHeight=r(this.container.node()),isNaN(this.originalWidth)||isNaN(this.originalHeight))throw"container not found";this.margin=e.utils.copy(this.originMargin),this.svg.attr("width",this.originalWidth).attr("height",this.originalHeight);var a=this.refreshAnimationTime,o=this.refreshAnimationEase,s=this.components,l=this.charts;for(var i in s)if(s.hasOwnProperty(i)){var c=s[i];c.refresh(o,a)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var i in l)if(l.hasOwnProperty(i)){var h=l[i];h.refresh(o,a)}}catch(u){"string"==typeof u?delete t[i]:console.error(u.stack)}},_updateSeries:function(t){this.config.series=e.utils.copy(t,!0),this.margin=e.utils.copy(this.originMargin);var i=this.components,n=this.charts;for(var r in i)if(i.hasOwnProperty(r)){var a=i[r];a.updateSeries(this.config.series)}this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];o.updateSeries(this.config.series)}},on:function(t,e){var i=this.EventList,n=t.split("."),r=n[0],a=n[1]?n[1]:"default";i[r]||(i[r]=[]);for(var o,s=0;o=i[r][s++];)if(o.nameSpace==a){i[r].splice(s-1,1);break}i[r].push({nameSpace:a,callback:e})},fire:function(t){var e=Array.prototype.slice.call(arguments,1),i=this.EventList[t];i&&i.forEach(function(t){t.callback.apply("",e)})}}),e.prototype.init.prototype=e.prototype,e.extend({charts:{extend:e.extend},components:{extend:e.extend},utils:{extend:e.extend}});var d={enable:!1,animationTime:500,animationEase:"easeLinear"},f={enable:!1};return function(e){function i(t,e){if(!t)return t;var i=f.getType(t);if("Object"==i||"Array"==i){var n,r="Object"==i?{}:[];for(var a in t)t.hasOwnProperty(a)&&(n=t[a],e&&(f.isObject(n)||f.isArray(n))?r[a]=arguments.callee(n,!0):r[a]=t[a]);return r}return t}function n(t,e){var i;for(var n in e)if(e.hasOwnProperty(n)){if(i=e[n],f.isObject(i))t[n]=t[n]||{};else{if(!f.isArray(i)){t[n]=e[n];continue}t[n]=t[n]||[]}arguments.callee(t[n],e[n],!0)}return t}function r(t,e){function i(){this.superClass=e.prototype}t.prototype;i.prototype=e.prototype,t.prototype=new i,t.constructor=t}function a(t){return t}function o(t){return t||Array.isArray(t)||(t=["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]),function(e){return t[e%t.length]}}function s(t,e,i,n){Array.isArray(t)||(t=[t]),void 0===i&&(i=2),void 0===n&&(n=2);var r=document.createElement("span");r.style.fontSize=e+"px",r.style.fontFamily="sans-serif",r.style.margin="0px",r.style.padding="0px",r.style.border="none",r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r);var a=[],o=[];return t.forEach(function(t){r.textContent=t;var e=parseFloat(r.offsetWidth)+i,s=parseFloat(r.offsetHeight)+n;a.push(e),o.push(s)}),document.body.removeChild(r),{widthList:a,heightList:o}}function l(t,e,i,n){var r,a,o,s=+new Date,l=0,c=0,h=null,u=function(){c=s,t.apply(a,o)};return function(){s=+new Date,a=this,o=arguments,r=s-(n?l:c)-e,clearTimeout(h),n?i?h=setTimeout(u,e):r>=0&&u():r>=0?u():i&&(h=setTimeout(u,-r)),l=s}}function c(t,e,i){return l(t,e,i,!0)}function h(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function u(e){var i=t[e];return void 0===i&&f.isString(e)&&(console.warn("animation.animationEase="+e+" is not defined"),i=t.easeLinear),i}function d(t,e){var i;return i="M"+t+" "+(e-7)+"L"+(t-7)+" "+(e-14)+"A10 10, 0, 1, 1, "+(t+7)+" "+(e-14)+"Z"}var f=e.utils,p=Object.prototype.toString,g=["Arguments","Object","Array","Function","String","Number","Date","RegExp","Error"];g.forEach(function(t){f["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),f.getType=function(t){var e=p.call(t),i=e.match(/\[object\s(\w+?)\]/)[1];return i},f.copy=i,f.merage=n,f.inherits=r,f.loop=a,f.getColor=o,f.calcTextWidth=s,f.throttle=l,f.debounce=c,f.toFixed=h,f.stringToD3Ease=u,f.peekPointOfDrop=d}(e),function(t){function e(t,e,i){this.messageCenter=t,this.config=e,this.type=i,this.main=t.main,this.margin=t.margin,this.svg=t.svg,this.div=t.div,this.mobileMode=t.mobileMode,this.start()}e.prototype={constructor:e,start:function(){this.init(this.messageCenter,this.config,this.type,this.config.series);var t=this.messageCenter.config.animation.animationTime,e=this.messageCenter.config.animation.animationEase;this.render(e,t),this.ready()},init:function(t,e,i){},render:function(t,e){},ready:function(){},refresh:function(t,e){return!this._show||(this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.init(this.messageCenter,this.config,this.type,this.config.series),void this.render(t,e))},updateSeries:function(t){return!this._show||(this.init(this.messageCenter,this.config,this.type,t),this.render("linear",0),void this.ready())},on:function(){this.messageCenter.on.apply(this.messageCenter,arguments)},fire:function(){this.messageCenter.fire.apply(this.messageCenter,arguments)}},t.components.extend({Component:e})}(e),function(t,e){function i(t,e,i){this._show=!0,g.Component.call(this,t,e,i)}function n(t,e){t.forEach(function(t){"value"===t.scaleType||"time"===t.scaleType?t.range(e):"barCategory"===t.scaleType||"middleCategory"===t.scaleType?(t.range(e),t.paddingOuter(.1)):"category"===t.scaleType&&t.range(e)})}function r(t,i,n,r,a){if(i){var o=r.domain().map(function(t){return n.tickFormat(t)}),s=p.calcTextWidth(o,14).widthList,l=s[s.length-1],c=t.margin.right;l/2>c&&(t.margin.right+=Math.round(l/2)-c);var h=s[0],u=t.margin.left;h/2>u&&(t.margin.left+=Math.round(h/2)-u)}else{var o=r.ticks().map(function(t){return n.tickFormat(t)}),s=p.calcTextWidth(o,14).widthList,d=e.max(s);d=void 0==d?0:d,"right"===n.position?t.margin.right+=d:t.margin.left+=d}}function a(t,e,i){var n=x[t.type];return n?n.call(i,t,e):void console.error('axis[%d].type = "%s" is not supported',e,t.type)}function o(t,i){if(!t.data)return void console.error("axis[%d].data is not defined!",i);if(u(this.config.series)||this.config.xAxis[i].middleBand){var n=e.scaleBand().domain(t.data);n.scaleType=u(this.config.series)?"barCategory":"middleCategory"}else{var n=e.scalePoint().domain(t.data);n.scaleType="category"}return n}function s(t,i){var n=this.series,r=this.type;n.map(function(t){null==t[r+"Index"]&&(t[r+"Index"]=0)});var a=[],o=[];for(var s in m)if(m.hasOwnProperty(s)){var l=m[s](n,r,i);l&&a.push(l)}o[0]=e.min(a,function(t){return t[0]}),o[1]=e.max(a,function(t){return t[1]}),o[0]===o[1]&&null!=o[0]&&null!=o[1]&&(o[0]?o[0]>0?o[0]=0:o[1]=0:o[1]=1),o[0]===-(1/0)&&(o[1]>0?o[0]=0:(o[1]=0,o[0]=-10)),o[1]===1/0&&(o[0]<0?o[1]=0:(o[0]=0,o[1]=10)),(o[0]>t.minValue||void 0===o[0])&&(o[0]=t.minValue),(o[1]<t.maxValue||void 0===o[1])&&(o[1]=t.maxValue);var c=e.scaleLinear().domain(o);if(c.scaleType="value",t.ticks<2||this.legendRefresh){var h=c.ticks().length,u=Math.ceil(h/2);u>=2&&(t.ticks=u)}var u=c.ticks(t.ticks),d=u[1]-u[0];if(o[0]%d!==0&&!isNaN(d)){var f=parseInt(o[0]/d);f<0&&f--,o[0]=f*d}if(o[1]%d!==0&&!isNaN(d)){var f=parseInt(o[1]/d);f>=0&&f++,o[1]=f*d}return c.domain(o),c}function l(t,i){var n=e.scaleTime().domain(e.extent(t.data,function(t){return+new Date(t)}));if(this.isXAxis){for(var r,a=this.config.series,o=1,s=0;r=a[s++];){var l=void 0==r.xAxisIndex?0:r.xAxisIndex;if("line"==r.type&&l==i){o=r.data.length-1;break}}var c=n.domain(),h=c[1]-c[0],u=h/o;t.data=[+c[0]];for(var s=0;s<o;s++)t.data[s+1]=+c[0]+Math.round(u*(s+1),1)}return n.scaleType="time",n}function c(t,i){for(var n=[],r=0;r<t.length;r++){var a=t[r];if("category"===a.scaleType||"barCategory"===a.scaleType||"middleCategory"===a.scaleType){for(var o=p.copy(a.domain()),s=a.range(),l=i[r],c=o.map(function(t){return l.tickFormat(t)}),h=p.calcTextWidth(c,14).widthList,u=e.max(h),d=Math.ceil((s[s.length-1]-s[0])/(o.length-1)),f=0,g=1;g<h.length;g++){var x=u,m=u;(x+m)/2>d*(g-f)?o[g]=null:f=g}o=o.filter(function(t){return null!==t}),n.push(o)}}return n}function h(t){var e=t.position,i=[0,0];return"right"==e?i=[this.width,0]:"bottom"==e&&(i=[0,this.height]),"translate("+i+")"}function u(t){for(var e,i=0;e=t[i++];)if("bar"===e.type)return!0;return!1}function d(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n],a=e[n].data,o={};r.forEach(function(t){for(var e=0;e<a.length&&t!==a[e];e++);e==a.length&&console.error("data和value不匹配"),o[e]=!0}),i[n]=o}return i}function f(t){var e={tickFormat:p.loop,middleBand:!1,ticks:-1,formatter:function(t){return"<p>"+this.tickFormat(t)+"</p>"},position:"xAxis"==t?"bottom":"left",show:!0,grid:{show:"xAxis"!==t,opacity:.2,color:"#a2a2a2",controlSingleLineShow:function(){return!0}}};return e}var p=t.utils,g=t.components;p.inherits(i,g.Component),g.extend({axis:i}),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,o){this.isXAxis="xAxis"===i,this.axisConfig=e[i],this.series=o,this.mergeConfig=[];for(var s=[],l=0;l<this.axisConfig.length;l++){var e=p.merage(f(i),this.axisConfig[l]);this.mergeConfig[l]=e;var h=a(e,l,this),u=h.domain();if(isNaN(u[0])&&isNaN(u[1])&&"value"===h.scaleType){if(0===o.length)return;h=this.scales[l]}this.legendRefresh||r(this,this.isXAxis,e,h),s[l]=h,this.axisConfig[l]=e}this.width=t.originalWidth-t.margin.left-t.margin.right,this.height=t.originalHeight-t.margin.top-t.margin.bottom,this.range=this.isXAxis?[0,this.width]:[this.height,0],n(s,this.range),this.isXAxis&&(this.showDomainList=c(s,this.axisConfig),t.showDomainList=d(this.showDomainList,this.axisConfig)),this.messageCenter[this.type+"Scale"]=s,this.scales=s},render:function(t,e){return this.isXAxis?(this.__drawAxis(t,e),this.fire("xAxisRender"),!0):void this.on("xAxisRender.yAxis",function(){this.width=this.messageCenter.originalWidth-this.margin.left-this.margin.right,this.__drawAxis(t,e)}.bind(this))},__drawAxis:function(t,i){for(var n,r=this.type,a=this.scales,o=0;(n=this.axisConfig[o])&&n.show;o++){var s,l=a[o];switch(n.position){case"left":s=e.axisLeft(l);break;case"right":s=e.axisRight(l);break;case"bottom":s=e.axisBottom(l);break;default:s=e.axisTop(l)}s.tickSizeOuter(0).tickFormat(n.tickFormat),"time"!==l.scaleType&&s.ticks(n.ticks);var c=0;this.isXAxis||0!==o?0===o?(c=n.grid.show?-this.height:0,s.tickSizeInner(c),s.tickPadding(10),s.tickValues(this.showDomainList[o])):s.tickSizeInner(0):(c=n.grid.show?-this.width:0,s.tickSizeInner(c));var u=this.main.selectAll(".xc-axis."+r+"-"+o).data([n]);u=u.enter().append("g").attr("class","xc-axis "+r+" "+r+"-"+o).attr("fill","none").attr("stroke","#000").merge(u),"barCategory"===l.scaleType&&u.classed("xc-bar-axis",!0),u.attr("transform",h.call(this,n)).transition().ease(t).duration(i).call(s),u.selectAll(".tick>line").attr("opacity",function(t,e){return 0!==e&&n.grid.controlSingleLineShow(t)?n.grid.opacity:0}).attr("stroke",function(t,e){if(0!==e)return n.grid.color})}},ready:function(){this._tooltipReady(),this._lengendReady(),this.isXAxis&&this._brushReady(),this.isXAxis&&this.fire("xAxisReady")},_tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"===this.config.tooltip.trigger&&"yAxis"!=this.type){var t=this.axisConfig[0];this.on("tooltipSectionChange.axis",function(e,i){var n=t.data[e],r=t.formatter(n);i(r)})}},_lengendReady:function(){var t=this;this.on("legendClick."+t.type,function(e){var i=t.series;i.forEach(function(t){var i=t.name;t.show=!1;for(var n,r=0;n=e[r++];)if(n==i){t.show=!0;break}}),t.legendRefresh=!0,t.init(t.messageCenter,t.config,t.type,i),t.render(t.config.animation.animationEase,t.config.animation.animationTime),t.legendRefresh=!1})},_brushReady:function(){var t=this.scales[0].copy();t.range([0,1]),this.on("brushChange.axis",function(i){var n=[t.invert(i[0]),t.invert(i[1])];this.scales[0].domain(n),this.__drawAxis(e.easeLinear,0)}.bind(this))},tickFormat:function(t,e){return e=void 0===e?0:e,this.mergeConfig[e].tickFormat(t)}});var x={value:s,time:l,category:o},m={line:function(t,i,n){var r={},a=[];e.map(t,function(t){return"line"===t.type&&t[i+"Index"]===n&&t.show!==!1&&(t.stack&&(r[t.stack]||(r[t.stack]=[]),r[t.stack].push(t.data)),void(a=a.concat(t.data)))});for(var o in r)if(r.hasOwnProperty(o)){var s=[];r[o].forEach(function(t,e){t.forEach(function(t,e){s[e]=null==s[e]?0:s[e],s[e]+=parseFloat(t)})}),a=a.concat(s)}return 0!=a.length&&e.extent(a,function(t){return parseFloat(t)})},bar:function(t,i,n){var r={},a=[];e.map(t,function(t){return"bar"===t.type&&t[i+"Index"]===n&&t.show!==!1&&(t.legendShow===!1&&void 0===t.axisLegendShow?(t.axisLegendShow=!0,!1):(t.stack&&(r[t.stack]||(r[t.stack]=[]),r[t.stack].push(t.data)),void(a=a.concat(t.data))))});for(var o in r)if(r.hasOwnProperty(o)){var s=[];r[o].forEach(function(t){t.forEach(function(t,e){s[e]=null==s[e]?0:s[e],s[e]+=parseFloat(t)})}),a=a.concat(s)}return 0!=a.length&&e.extent(a,function(t){return parseFloat(t)})},scatter:function(t,i,n){var r=[];return e.map(t,function(t){"scatter"===t.type&&t[i+"Index"]===n&&t.show!==!1&&e.map(t.data,function(t){r.push(t["xAxis"==i?0:1])})}),0!=r.length&&e.extent(r,function(t){return parseFloat(t)})}}}(e,t),function(t,e){function i(t,e,i){return e.guides.show===!1||void 0===t.xAxisScale||void 0===t.yAxisScale?void(this._show=!1):(this._show=!0,void h.call(this,t,e,i))}function n(){var t=this.guidesConfig,e=this.svg.selectAll("line.xc-scatter-line-x").data([this]);e=e.enter().append("line").attr("class","xc-scatter-line-x").style("pointer-events","none").attr("stroke-width",t.lineStyle.width).attr("stroke",t.lineStyle.color).attr("stroke-dasharray",t.lineStyle.dasharray).merge(e);var i=this.svg.selectAll("line.xc-scatter-line-y").data([this]);i=i.enter().append("line").attr("class","xc-scatter-line-y").style("pointer-events","none").attr("stroke-width",t.lineStyle.width).attr("stroke",t.lineStyle.color).attr("stroke-dasharray",t.lineStyle.dasharray).merge(i),this.width=this.messageCenter.originalWidth-this.margin.left-this.margin.right,this.height=this.messageCenter.originalHeight-this.margin.top-this.margin.bottom;var n=this.margin.left,r=this.margin.left+this.width,a=this.margin.top,o=this.height+a;e.attr("x1",n).attr("x2",n).attr("y1",a).attr("y2",o).style("display","none"),i.attr("x1",n).attr("x2",r).attr("y1",a).attr("y2",a).style("display","none"),this.xLine=e,this.yLine=i}function r(){var t=this.guidesConfig,e=this.svg.selectAll("text.xc-scatter-assitline").data([this]).enter().append("text").attr("class","xc-scatter-assitline").attr("text-anchor","left"),i=e.selectAll("tspan.xc-span").data([this]).enter().append("tspan").attr("class","xc-span").attr("fill",t.textStyle.color).attr("font-size",t.textStyle.fontSize);this.textBox=e,this.textSpan=i}function a(t){var i=t.textSpan,n=t.textBox,r=t.margin,a=t.messageCenter.yAxisScale[0],s=t.messageCenter.xAxisScale[0],l=t.xLine,c=t.yLine,h=t.guidesConfig.textStyle.xFormat,u=t.guidesConfig.textStyle.yFormat;return function(){if("value"===s.scaleType&&"value"===a.scaleType){var d=e.mouse(t.svg.node());if(!o(t,d))return l.style("display","none"),c.style("display","none"),n.style("display","none"),!1;var f=d[0]-r.left,p=d[1]-r.top,g=s.invert(f).toFixed(2),x=a.invert(p).toFixed(2);n.style("display","block"),i.text(h(g)+","+u(x)),l.attr("x1",d[0]).attr("x2",d[0]).style("display","block"),c.attr("y1",d[1]).attr("y2",d[1]).style("display","block"),d[1]-=10,d[0]+=10,n.attr("transform","translate("+d.join(",")+")")}}}function o(t,e){var i=t.margin.left,n=t.margin.left+t.width;if(e[0]<=i||e[0]>=n)return!1;var r=t.margin.top,a=t.margin.top+t.height;return!(e[1]<=r||e[1]>=a)}function s(){return{show:!0,lineStyle:{color:"#a2a2a2",width:1,dasharray:5},textStyle:{color:"#a2a2a2",fontSize:14,xFormat:l.loop,yFormat:l.loop}}}var l=t.utils,c=t.components,h=c.Component;l.inherits(i,h),c.extend({guides:i}),i.prototype.extend=l.extend,i.prototype.extend({init:function(){this.guidesConfig=l.merage(s(),this.config.guides)},render:function(){n.call(this),r.call(this)},ready:function(){this.mobileMode?this.mobileReady():this.div.on("mousemove.scatter",a(this))}}),i.assitLineTrigger=a}(e,t),function(t,e){var i=(t.utils,t.components),n=i.guides;n.prototype.extend({mobileReady:function(){var t=n.assitLineTrigger(this);this.div.on("touchmove.scatter",t),this.div.on("touchstart.scatter",t)}})}(e,t),function(t,e){function i(t,e,i){e.resize.enable&&s.Component.call(this,t,e,i)}function n(t){l[t.messageCenter.id]=t}function r(t){delete l[t.messageCenter.id]}function a(){var t={enable:!1,animationEase:"easeLinear",animationTime:300};return t}var o=t.utils,s=t.components;o.inherits(i,s.Component),s.extend({resize:i});var l={};e.select(window).on("resize.refresh",function(){for(var t in l)l.hasOwnProperty(t)&&l[t].resize(l,t)}),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,n){this.config=o.merage(a(),e[i]),this.config.animationEase=o.stringToD3Ease(this.config.animationEase),t.refreshAnimationEase=this.config.animationEase,t.refreshAnimationTime=this.config.animationTime},ready:function(){e.select(window);var t=this,i=t.config.animationTime,r=o.debounce(function(e,i){t.messageCenter.refresh(e,i)},i+300,!0);t.resize=r,n(t),t.on("chartRemoveBind",function(){t.unBind()})},unBind:function(){r(this)},refresh:function(){},updateSeries:function(){}})}(e,t),function(t,e){function i(t,e,i){return e.brush.show===!1?void(this._show=!1):(this._show=!0,void c.call(this,t,e,i))}function n(t){var e=parseFloat(t.brushConfig.domain[0]),i=parseFloat(t.brushConfig.domain[1]);if(isNaN(e)||isNaN(i))return console.warn("brush.domain is not percentage value",t.brushConfig.domain),[0,0];var n=t.width,r=[n*e/100,n*i/100];return t.initBrushSelection=[s.toFixed(r[0]/n,3),s.toFixed(r[1]/n,3)],r}function r(t){var i=t.width;return function(){var n=e.event.selection,r=s.toFixed(n[0]/i,3),a=s.toFixed(n[1]/i,3);t.fire("brushChange",[r,a])}}function a(t){return[[0,0],[t.width,t.brushConfig.brushHeight]]}function o(){return{show:!0,domain:["90%","100%"],brushHeight:30}}var s=t.utils,l=t.components,c=l.Component;s.inherits(i,c),l.extend({brush:i}),i.prototype.extend=s.extend,i.prototype.extend({init:function(t,e){this.messageCenter.brush=!0,this.brushConfig=s.merage(o(),e.brush),this.margin.bottom+=this.brushConfig.brushHeight+20;var t=this.messageCenter;this.width=t.originalWidth-t.margin.left-t.margin.right},render:function(){var t=e.brushX();t.extent(a(this));var i=0,r=this.messageCenter.originalHeight-this.margin.bottom,o=this.messageCenter.originalWidth-this.margin.left-this.margin.right,s=this.messageCenter.originalHeight-this.margin.top-this.margin.bottom,l=this.main.selectAll("g.xc-brush").data([this]);l=l.enter().append("g").attr("class","xc-brush").merge(l),l.attr("transform","translate("+i+","+r+")").call(t),t.move(l,n(this)),l.selectAll("rect.overlay").attr("fill","#e0e0e0").attr("opacity",.5),l.selectAll("rect.handle").attr("fill","#777"),this.brush=t;var c=this.svg.selectAll("defs").data([this]);c=c.enter().append("defs").merge(c);var h=c.selectAll("clipPath#xc-clip-main-path").data([this]);h=h.enter().append("clipPath").attr("id","xc-clip-main-path").merge(h);var u=h.selectAll("rect").data([this]);u=u.enter().append("rect").merge(u),u.attr("width",o).attr("height",s)},ready:function(){var t=(this.brush,r(this));this.brush.on("brush",t),this.on("xAxisRender.brush",function(){this.fire("brushChange",this.initBrushSelection)}.bind(this)),this.on("xAxisReady.brush",function(){this.fire("brushChange",this.initBrushSelection)}.bind(this))},refresh:function(t,e){return!this._show||(this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.init(this.messageCenter,this.config,this.type,this.config.series),this.render(t,e),void this.ready())}})}(e,t),function(t,e){function i(t,e,i){return e.legend.show===!1?void(this._show=!1):(this._show=!0,void p.call(this,t,e,i))}function n(t,i,n){return function(a){return t.legendConfig.clickable===!1||(t.messageCenter.lengendChange=!0,this.isChecked=!this.isChecked,l?e.select(this).attr("opacity",this.isChecked?1:n):(this.itemList.attr("opacity",n),e.select(this).attr("opacity",1)),void r.call(t,a.name,l,i,t.legendSeries))}}function r(t,e,i,n){i=[],e?(n.forEach(function(e){e.name===t&&(e.isChecked=!e.isChecked),e.isChecked===!0&&i.push(e.name)}),0==i.length?this.fire("tooltipNone"):this.fire("tooltipShow")):i=[t],this.fire("legendClick",i)}function a(){var t=this,i=t.legendConfig,n=t.legendSeries,r=i.itemGap,a=t.width,o=t.height,s=t.legendConfig.item.fontSize,l=t.legendConfig.item.chartSize,c=s>l?s:l,h=i.x,u=i.y,f=i.orient,p=t.margin,g=t.originalWidth,x=1.1*i.item.chartSize,m=n.map(function(t){return t.name}),y=d.calcTextWidth(m,i.item.fontSize,x).widthList,v=0,b=0,C=0,w=0,S=0;n.forEach(function(t,i){var n=y[i];t.position=[v,b],"vertical"!=f?(v+=n+r,v-r>a&&(C=a,v=0,b+=1.1*c,t.position=[v,b],v=n+r)):(S=e.max([S,n]),b+=c+r,b>o&&(w=o,b=0,v+=1.1*S))});var A,k,_=30;return C=C?C:v,w=w?w:b,"vertical"!=f?(w+=c,A="right"==h?g-p.right-C:"center"==h?(a-C)/2+p.left:p.left,"top"==u?(k=p.top,p.top+=b+_):(k=o-b+p.top,p.bottom+=b+_)):(C+=S,"right"==h?(A=g-p.right-C,p.right+=C+_):(A=0,p.left+=C+_),k="center"==u?(o-w)/2+p.top:"bottom"==u?o-w+p.top:p.top),[A,k]}function o(t,e,i){var n={},r=[];t.forEach(function(t){var e=t.type;e&&(n[e]||(n[e]=[]),n[e].push(t))});for(var a in n)if(n.hasOwnProperty(a)){var o=s(a);o&&(r=r.concat(o(n[a],e,i)))}return r.forEach(function(t){t.isChecked=t.legendShow!==!1}),r}function s(t){switch(t){case"radar":case"funnel":case"pie":return l;default:return c}}function l(t,e,i){var n=[];return t.forEach(function(t){var r={},a=0,o=t.type;t.data.forEach(function(t){var s,l=t.name;void 0==r[l]?(r[l]=a,s=a):s=r[l],t.idx=s,h(l,e)&&(t.color=i.getColor(s),t.type=o,n.push(t)),a++})}),n}function c(t,e,i){var n=[],r=i.getColor;return t.forEach(function(t,i){void 0===t.idx&&(t.idx=i),h(t.name,e)&&(t.lineStyle&&"auto"!==t.lineStyle.color?t.color=t.lineStyle.color:t.color=r(i),n.push(t))}),n}function h(t,e,i){for(var n,r=0;n=e[r++];){if(i&&n[i]===t)return n;if(n===t)return n}return!1}function u(){var t={show:!1,orient:"horizontal",x:"center",y:"bottom",itemGap:10,formatter:function(t){return t},selectedMode:"multiple",data:[],item:{fontSize:14,color:"#000",chartSize:20,opacity:.3,hoverColor:"auto"},clickable:!0};return t}var d=t.utils,f=t.components,p=f.Component;d.inherits(i,p),f.extend({legend:i}),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e){t.lengendChange=!1,this.legendConfig=d.merage(u(),e.legend),this.legendSeries=o(e.series,this.legendConfig.data,t),this.originalHeight=t.originalHeight,this.originalWidth=t.originalWidth,this.width=this.originalWidth-this.margin.left-this.margin.right,this.height=this.originalHeight-this.margin.top-this.margin.bottom,this.groupPosition=a.call(this)},render:function(){var t=this,e=t.legendConfig.item.fontSize,i=t.legendConfig.item.chartSize,n=t.legendConfig.item.color,r=t.groupPosition,a=t.svg.selectAll(".xc-legend-group").data([t]);a=a.enter().append("g").attr("class","xc-legend-group").merge(a),a.attr("transform","translate("+r+")");var o=a.selectAll(".xc-legend-item").data(t.legendSeries);o=o.enter().append("g").attr("class","xc-legend-item").merge(o),o=o.exit().remove().merge(o),o.attr("transform",function(t){return void 0===this.isChecked&&(this.isChecked=t.isChecked),"translate("+t.position+")"}).attr("fill",n).attr("opacity",function(){return this.isChecked?1:t.legendConfig.item.opacity}),o.html(""),o.append("text").attr("x",1.1*i).attr("y",function(){return.325*i+.25*e}).append("tspan").text(function(t){return t.name}).attr("font-size",e),o.append("rect").attr("width",.9*i).attr("height",.5*i).attr("rx",.1*i).attr("ry",.1*i).attr("stroke",function(t){return t.color}).attr("fill",function(t){return t.color}).style("transform",function(){}),t.itemList=o},ready:function(){var t=this,i=t.legendConfig,r=i.item.hoverColor,a=i.item.color,o="single"!=i.selectedMode,s=i.item.opacity,l=o?this.legendSeries.map(function(t){return t.name}):[];t.mobileMode?t.mobileReady(l,s):(t.itemList.on("click.legend",n(this,l,s)),t.itemList.on("mouseenter.legend",function(i){var n;n="auto"==r?i.color:r;var a=e.select(this);a.attr("fill",n),t.fire("legendMouseenter",i.name)}),t.itemList.on("mouseleave.legend",function(i){var n=e.select(this);n.attr("fill",a),t.fire("legendMouseleave",i.name)}))}}),i.legendMouseClick=n}(e,t),function(t,e){var i=(t.utils,t.components),n=i.legend;n.prototype.extend({mobileReady:function(t,e){this.itemList.on("click.legend",n.legendMouseClick(this,t,e))}})}(e,t),function(t,e){function i(t,e,i){return e.title.show===!1?void(this._show=!1):(this._show=!0,void s.call(this,t,e,i))}function n(){var t=this,e="start",i=t.titleConfig.textStyle.fontSize,n=t.titleConfig.subtextStyle.fontSize,r=t.titleConfig.x,a=t.titleConfig.y,o=t.height;return"left"===r?(r=0,e="start"):"center"===r?(r="50%",e="middle"):"right"===r&&(r="100%",e="end"),"top"==a?(a="1em",t.margin.top+=1.5*parseFloat(i)+parseFloat(n)):"center"==a?a="50%":"bottom"==a&&(a=o-parseFloat(n)-parseFloat(i)),{x:r,y:a,textAnchor:e}}function r(){var t={show:!0,text:"",subtext:"",x:"center",y:"top",textStyle:{fontSize:14,color:"#000"},subtextStyle:{fontSize:12,color:"#00"}};return t}var a=t.utils,o=t.components,s=o.Component;a.inherits(i,s),o.extend({title:i}),i.prototype.extend=t.extend,i.prototype.extend({init:function(t){this.titleConfig=a.merage(r(),this.config.title),this.height=t.originalHeight,this.titlePosition=n.call(this)},render:function(){var t=this,e=t.titleConfig.textStyle.fontSize,i=t.titleConfig.subtextStyle.fontSize,n=t.titlePosition.x,r=t.titlePosition.y,a=t.titlePosition.textAnchor,o=t.svg.selectAll(".xc-title").data([t.titleConfig]);o=o.enter().append("text").attr("class","xc-title").merge(o);var s=o.selectAll(".xc-title-text").data([t.titleConfig]);s=s.enter().append("tspan").attr("class","xc-title-text").merge(s),s.text(function(t){return t.text}).attr("x",n).attr("y",r).attr("font-size",e).attr("fill",function(t){return t.textStyle.color}).attr("text-anchor",a);var l=o.selectAll(".xc-title-subtext").data([t.titleConfig]);l=l.enter().append("tspan").attr("class","xc-title-subtext").merge(l),l.text(function(t){return t.subtext}).attr("x",n).attr("dy","1.2em").attr("fill",function(t){return t.subtextStyle.color}).attr("font-size",i).attr("text-anchor",a)},updateSeries:function(){}})}(e,t),function(t,e){function i(t,e,i){return e.tooltip.show===!1?void(this._show=!1):(this._show=!0,void d.call(this,t,e,i))}function n(t,e){var i=this.axisX,n=this.axisY;return t<i[0]||t>i[1]||e<n[0]||e>n[1]}function r(){var t=this.main.selectAll(".xc-tooltip-line").data([this]);return t=t.enter().append("line").attr("class","xc-tooltip-line").attr("stroke",this.tooltipConfig.lineColor).attr("stroke-width",this.tooltipConfig.lineWidth).attr("opacity",0).merge(t)}function a(t){t.axisX=[],t.axisX[0]=t.margin.left,t.axisX[1]=t.originalWidth-t.margin.right,t.axisY=[],t.axisY[0]=t.margin.top,t.axisY[1]=t.originalHeight-t.margin.bottom}function o(t){var i=-1,o=!0,c=-1;return function(){if(t.display!==!1){o&&(o=!1,a(t),t.axisLine=r.call(t));var h=e.mouse(this),u=h[0],d=h[1],f=t.axisLine;if(n.call(t,u,d))return void t.hiddenTooltip();t.tooltipShow||t.showTooltip();var p=t.messageCenter.xAxisScale[0],g=t.config.xAxis[0].data,x=t.originalWidth-t.margin.left-t.margin.right,m=t.originalHeight-t.margin.top-t.margin.bottom,y=l.call(t,g),v=y.length-1;"barCategory"===t.messageCenter.xAxisScale[0].scaleType&&v++;var b=x/v,C=0;if(C="barCategory"===t.messageCenter.xAxisScale[0].scaleType?Math.floor((u-t.margin.left)/b):Math.round((u-t.margin.left)/b),C+=y.offset,C!==i||t.messageCenter.lengendChange){t.messageCenter.lengendChange=!1;var w="";t.fire("tooltipSectionChange",C,function(e){w+=e,t.setTooltipHtml(w)},t.tooltipConfig.formatter),c=t.messageCenter.charts.bar||t.config.xAxis[0].middleBand?s(p,C):p(g[C]),f.attr("x1",c).attr("x2",c).attr("y1",0).attr("y2",m),c+=t.margin.left,i=C}t.setPosition([c,d])}}}function s(t,e){var i=t.bandwidth(),n=t.domain().length,r=t.range(),a=(r[1]-r[0]-i*n)/2;return r[0]+a+e*i+i/2}function l(t){if(this.messageCenter.brush!==!0)return{length:t.length,offset:0};for(var e,i=this.brushDomain||[0,1],n=t[0],r=t[t.length-1],a=[(r-n)*i[0]+n,(r-n)*i[1]+n],o=0,s=0;s<t.length;s++)t[s]<=a[1]&&t[s]>=a[0]&&(o++,
void 0===e&&(e=s));return{length:o,offset:e}}function c(){var t={show:!0,trigger:"axis",lineColor:"#CCC",lineWidth:2};return t}var h=t.utils,u=t.components,d=u.Component;h.inherits(i,d),u.extend({tooltip:i}),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e){this.originalWidth=t.originalWidth,this.originalHeight=t.originalHeight,this.xAxisScale=t.xAxisScale,this.axisX=null,this.axisY=null,this.tooltipWidth=null,this.tooltipHeight=null,this.display=!0,this.tooltipShow=!1,(!this.config.xAxis||this.config.xAxis.length>1||"value"==this.config.xAxis[0].type)&&(this.config.tooltip.trigger="item"),this.tooltipConfig=h.merage(c(),e.tooltip),e.tooltip=this.tooltipConfig},render:function(){this.tooltip=this.div.append("div").attr("class","xc-tooltip")},ready:function(){var t=this;"axis"===t.tooltipConfig.trigger&&(t.on("tooltipNone",function(){t.display=!1}),t.on("tooltipShow",function(){t.display=!0}),t.mobileMode?t.mobileReady():(t.div.on("mousemove.tooltip",o(t)),t.div.on("mouseleave.tooltip",function(){t.hiddenTooltip()})),this.on("brushChange.tooltip",function(e){t.brushDomain=e}))},refresh:function(){return!this._show||(this.hiddenTooltip(),this.init(this.messageCenter,this.config,this.type,this.config.series),void this.ready())},updateSeries:function(){},showTooltip:function(){var t=this;t.tooltipShow=!0,t.tooltip.style("visibility","visible"),"axis"===this.tooltipConfig.trigger&&t.axisLine.attr("opacity",1)},hiddenTooltip:function(){var t=this;t.fire("tooltipHidden"),t.tooltipShow=!1,t.tooltip.style("visibility","hidden"),"axis"===this.tooltipConfig.trigger&&t.axisLine&&t.axisLine.attr("opacity",0),t.main.selectAll(".xc-tooltip-line").attr("opacity",0)},setPosition:function(t,e,i){var n=this;if(n.tooltipShow){e=e||5,i=i||5,n.tooltipWidth=n.tooltip.node().clientWidth,n.tooltipWidth=parseFloat(n.tooltipWidth),n.tooltipHeight=n.tooltip.node().clientHeight,n.tooltipHeight=parseFloat(n.tooltipHeight);var r=n.tooltipWidth,a=n.tooltipHeight,o=n.originalWidth,s=n.originalHeight,l=t[0],c=t[1];l+r>o?(l=l-r-e,l=l<0?0:l):l+=e,c+a>s?c=s-a-i:c+=i,a>s&&(c=(a-s)/2),n.tooltip.style("transform","translate("+l+"px,"+c+"px)")}},setTooltipHtml:function(t){this.tooltip.html(t)}}),i.tooltipMousemove=o}(e,t),function(t,e){var i=(t.utils,t.components),n=i.tooltip;n.prototype.extend({mobileReady:function(){this.div.on("touchmove.tooltip",n.tooltipMousemove(this)),this.div.on("touchstart.tooltip",n.tooltipMousemove(this))}})}(e,t),function(t,e){function i(t,e,i){this.width=t.width,this.height=t.height,this.id=t.id,this.getColor=t.getColor,r.call(this,t,e,i)}var n=t.utils,r=t.components.Component;n.inherits(i,r),i.prototype.extend=t.extend,i.prototype.extend({refresh:function(t,e){this.margin=this.messageCenter.margin,this.originalHeight=this.messageCenter.originalHeight,this.originalWidth=this.messageCenter.originalWidth,this.width=this.messageCenter.width,this.height=this.messageCenter.height,this.init(this.messageCenter,this.config,this.type,this.config.series),this.render(t,e)}}),t.charts.extend({Chart:i})}(e,t),function(t,e){function i(t,e){d.call(this,t,e,"line")}function n(t){return function(){var i=t.messageCenter.components.tooltip,n=i.tooltipConfig.formatter,r=t.messageCenter.components.xAxis.axisConfig,a=e.event.srcElement||e.event.target;a=e.select(a);var o=a.data()[0],s=o.value,l=o._serie.name,h=o._serie.formatter||n||c,u=h(l,s),d=o.x;d=r[o._serie.xAxisIndex].tickFormat(d);var f="<p>"+d+"</p>";i.showTooltip(),i.setTooltipHtml(f+u);var p=e.mouse(t.svg.node());i.setPosition(p),t.mobileMode&&t.circle.attr("r",function(){return this.circleRadius}),e.select(this).attr("r",function(){return 1.8*this.circleRadius})}}function r(t,e,i){var n={},r=0,s=[];e.forEach(function(t){if("line"==t.type){if(t=u.merage(h(),t),t.idx=null==t.idx?r++:t.idx,!t.stack)return void s.push(t);n[t.stack]||(n[t.stack]=[]),n[t.stack].push(t)}});var l=a(t,n,i);return s=o(t,s,i),s.concat(l)}function a(t,e,i){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var a=null,o="linear";e[r].forEach(function(e){if(e.show!==!1){var r=e.xAxisIndex,s=e.yAxisIndex,l=i.xAxis[r],c=(i.yAxis[s],t.xAxisScale[r]),h=t.yAxisScale[s],u=e.idx;e.interpolate=e.smooth?"monotone":"linear",e.y0Interpolate=o,e.xScale=c,e.yScale=h,o=e.interpolate,0===e.xScale.domain().length&&(e.data=[]),e.data=e.data.map(function(t,n){var r={},o=!0;if("value"!=l.type){r.x=l.data[n],void 0===r.x&&console.error("The length of xAxis.data and series.data is not match!",n);var s=h.domain()[1],d=h.domain()[0];a?(o=a[n]&&!a[n].justCircle,r.y0=o?a[n].y:d,r.y=parseFloat(t)+(o?a[n].y:0)):(r.y0=d,r.y=parseFloat(t)),r.isStackPoint=o,r.y>s&&(r.y=s),r.y<d&&(r.y=d),"number"==typeof r.y&&r.y!==r.y&&(r.justCircle=!0,t="-",r.y=s),r.x=l.data[n]}if(r.value=t,r.idx=u,r._serie=e,i.xAxis.middleBand){var f=c.bandwidth();r.adjustedX=c(r.x)+n*f/2}return r}),a=e.data}n.push(e)})}return n}function o(t,e,i){return e=e.map(function(e){if(e.show!==!1){var n=e.xAxisIndex,r=e.yAxisIndex,a=i.xAxis[n],o=(i.yAxis[r],t.xAxisScale[n]),s=t.yAxisScale[r],l=e.idx;if(e.interpolate=e.smooth?"monotone":"linear",e.y0Interpolate="linear",e.xScale=o,e.yScale=s,0===e.xScale.domain().length&&(console.error("xAxis.data is empty!"),e.data=[]),e.data=e.data.map(function(t,i){var n={};if("value"!=a.type){n.x=a.data[i],void 0===n.x&&console.error("The length of xAxis.data and series.data is not match!",i);var r=s.domain()[1],c=s.domain()[0];n.y=parseFloat(t),n.y>r&&(n.y=r),n.y<c&&(n.y=c),"number"==typeof n.y&&n.y!==n.y&&(n.justCircle=!0,t="-",n.y=r),n.y0=c}if(n.value=t,n.idx=l,n._serie=e,a.middleBand){var h=o.bandwidth();n.adjustedX=o(n.x)+h/2}return n}),i.peekPoints.enable){var c=u.copy(e.data);c.sort(function(t,e){return t.y<e.y?-1:t.y===e.y?0:1}),e.peekPoints=[c[0],c[c.length-1]]}}return e}).filter(function(t){return t.data.length>0})}function s(t,i){var n=e.line().x(function(t){return t.x}).y(function(t){return t.y}),r=e.line().x(function(t){return t.x}).y(function(t){return t.y0});n.curve("linear"===i.interpolate?e.curveLinear:e.curveMonotoneX);var a=n(t);r.curve("linear"===i.y0Interpolate?e.curveLinear:e.curveMonotoneX);var o=[],s=[];if(i.data.forEach(function(t,e){t.isStackPoint||o.push(e)}),o.length>0){var c=0;o.push(t.length);for(var h=0;h<o.length;h++){var u=o[h];u-c>0&&s.push(t.slice(c,u)),c=u+1}}else s=[t];var d="";return s.forEach(function(t){d+=r(t.reverse())}),t.reverse(),l(a,d,t)}function l(t,e,i){var n=i[0],r=i[i.length-1],a=[n.x,n.y],o=[r.x,r.y0];return t+"L"+o+e+"L"+a}function c(t,e){return""!==e?"<p>"+t+":&nbsp;"+e+"</p>":""}function h(){var t={name:"",type:"line",xAxisIndex:0,yAxisIndex:0,smooth:!0,lineStyle:{color:"auto",width:2,radius:3},areaStyle:{show:!1,color:"auto",opacity:.3},data:[],units:""};return t}var u=t.utils,d=t.charts.Chart;t.charts.extend({line:i}),u.inherits(i,d),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,n){this.xAxisScale=t.xAxisScale,this.yAxisScale=t.yAxisScale,this.series=r(this,n,e),this.timeModel="time"==e.xAxis[0].type},render:function(t,e){this.__renderArea(t,e),this.__renderLine(t,e),this.timeModel||this.__renderCircle(t,e),this.config.peekPoints.enable&&this.__renderPeek(t,e),this.timeModel&&this._brushRender()},__renderLine:function(t,i){var n=this.id,r=this,a="opacity "+i/2+"ms linear",o=this.main.selectAll(".xc-line-group").data([r]);o=o.enter().append("g").attr("class","xc-line-group").merge(o);var s=e.line().x(function(t){return t.x}).y(function(t){return t.y}),l=o.selectAll(".xc-line-path").data(r.series);l=l.enter().append("path").attr("class","xc-line-path").attr("fill","none").merge(l),l.exit().remove(),l.attr("stroke",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:r.getColor(t.idx)}).attr("stroke-width",function(t){return t.lineStyle.width}).attr("id",function(t){return"xc-line-path-id"+n+"-"+t.idx}).style("transition",a).style("opacity",function(t){return t.show===!1?0:.7}),l.transition().duration(i).ease(t).attrTween("d",function(t){var i=this;if(t.show===!1)return function(){return i.linePath};var n=t.data.map(function(e){return{x:e.adjustedX?e.adjustedX:t.xScale(e.x),y:t.yScale(e.y)}});if(void 0===this.transitionData){var a=t.yScale.range()[1];this.transitionData=t.data.map(function(e){return{x:e.adjustedX?e.adjustedX:t.xScale(e.x),y:t.yScale(a)}})}var o=e.interpolate(this.transitionData,n);return this.transitionData=n,function(n){var a=o(n),l=[],c=[];if(t.data.forEach(function(t,e){t.justCircle&&l.push(e)}),l.length>0){var h=0;l.push(a.length);for(var u=0;u<l.length;u++){var d=l[u];d-h>0&&c.push(a.slice(h,d)),h=d+1}}else c=[a];s.curve("linear"===t.interpolate?e.curveLinear:e.curveMonotoneX);var f="";return c.forEach(function(t){f+=s(t)}),1==n&&(i.linePath=f,r.fire("lineAnimationEnd")),f}}),this.lineGroup=o},__renderArea:function(t,i){var n=this.id,r=this,a="opacity "+i/2+"ms linear",o=r.main.selectAll(".xc-area-group").data([r]);o=o.enter().append("g").attr("class","xc-area-group").merge(o),o.exit().remove();var l=o.selectAll(".xc-line-area-path").data(r.series);l=l.enter().append("path").attr("class","xc-line-area-path").attr("stroke","none").merge(l),l.exit().remove(),l.attr("fill",function(t){return"auto"==t.areaStyle.color?"auto"==t.lineStyle.color?r.getColor(t.idx):t.lineStyle.color:t.areaStyle.color}).attr("id",function(t){return"xc-line-area-path-id"+n+"-"+t.idx}).style("transition",a).style("opacity",function(t){return t.show===!1?0:t.areaStyle.opacity}),l.transition().duration(i).ease(t).attrTween("d",function(t){var i=this;if(t.show===!1)return function(){return null==i.areaPath?"":i.areaPath};if(t.areaStyle.show===!1)return function(){return""};var n=t.data.map(function(e){return{x:e.adjustedX?e.adjustedX:t.xScale(e.x),y:t.yScale(e.y),y0:t.yScale(e.y0)}});void 0===i.areaData&&(i.areaData=t.data.map(function(e){return{x:t.xScale(e.x),y:t.yScale(e.y0),y0:t.yScale(e.y0)}}));var r=e.interpolate(this.areaData,n);return i.areaData=n,function(e){var n=r(e),a=[],o=[];if(t.data.forEach(function(t,e){t.justCircle&&a.push(e)}),a.length>0){var l=0;a.push(n.length);for(var c=0;c<=a.length;c++){var h=a[c];h-l>0&&o.push(n.slice(l,h)),l=h+1}}else o=[n];var u="";return o.forEach(function(e){u+=s(e,t)}),1==e&&(i.areaPath=u),u}})},__renderCircle:function(t,i){var n=this.id,r=this,a=r.messageCenter.showDomainList[0],o="opacity "+i/2+"ms linear",s=r.main.selectAll(".xc-circle-group").data(r.series);s=s.enter().append("g").attr("class",function(t){return"xc-circle-group"}).merge(s),s.attr("id",function(t){return s.exit().remove(),"xc-circle-group-id"+n+"-"+t.idx}).attr("fill",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:r.getColor(t.idx)});var l=s.selectAll("circle").data(function(t){return t.data});l=l.enter().append("circle").attr("class",function(t,e){return"xc-point xc-point-"+e}).merge(l),l.exit().remove(),l.style("transition",o).style("opacity",function(t){return"object"!=typeof t?0:.7}).style("display",function(t,e){return a[e]!==!0?(this.circleDisplay=!1,"none"):(this.circleDisplay=!0,"block")}).attr("r",function(t){return"object"==typeof t&&(this.circleRadius=t._serie.lineStyle.radius),this.circleRadius}),l.transition().duration(i).ease(t).attrTween("cx",function(t){var i=this;if("object"!=typeof t)return function(){return i.circleCX};var n=t.adjustedX?t.adjustedX:t._serie.xScale(t.x);i.circleCX=void 0==i.circleCX?n:i.circleCX;var r=e.interpolate(i.circleCX,n);return i.circleCX=n,function(t){return r(t)}}).attrTween("cy",function(t){var i=this;if("object"!=typeof t)return function(){return i.circleCY};var n=t._serie.yScale(t.y);if(void 0===i.circleCY){var r=t._serie.yScale.range()[1];i.circleCY=t._serie.yScale(r)}i.circleCY=void 0==i.circleCY?n:i.circleCY;var a=e.interpolate(i.circleCY,n);return i.circleCY=n,function(t){return a(t)}}),r.circle=l,r.circleGroup=s},__renderPeek:function(t,e){var i=this.id,n=this,r=n.messageCenter.showDomainList[0],a="opacity "+e/2+"ms linear",o=n.main.selectAll("xc-peek-group").data(n.series);o=o.enter().append("g").attr("class","xc-peek-group").merge(o),o.exit().remove(),o.attr("id",function(t){return"xc-peek-group-id"+i+t.idx}).attr("fill",function(t){return"auto"!=t.lineStyle.color?t.lineStyle.color:n.getColor(t.idx)});var s=o.selectAll("path").data(function(t){return t.peekPoints});s=s.enter().append("path").merge(s).attr("class",function(t,e){return"xc-peek-point xc-peek-point-"+e}).attr("d",function(t){var e=t.adjustedX?t.adjustedX:t._serie.xScale(t.x),i=t._serie.yScale(t.y);return u.peekPointOfDrop(e,i)}),s.exit().remove(),s.style("transition",a).style("opacity",function(t){return"object"!=typeof t?0:.7}).style("display",function(t,e){return r[e]!==!0?(this.circleDisplay=!1,"none"):(this.circleDisplay=!0,"block")});var l=o.selectAll("text").data(function(t){return t.peekPoints});l=l.enter().append("text").merge(l).text(function(t){return t.y}).attr("fill","#fff").attr("class",function(t,e){return"xc-peek-text xc-peek-text-"+e}).attr("x",function(t){return t.adjustedX?t.adjustedX:t._serie.xScale(t.x)}).attr("y",function(t){return t._serie.yScale(t.y)-21}).attr("text-anchor","middle").attr("dominant-baseline","middle").style("font-size","0.5em"),l.exit().remove()},_brushRender:function(){this.lineGroup.attr("clip-path","url(#xc-clip-main-path)")},ready:function(){this.mobileMode?this.mobileReady():(this.config.legend&&this.config.legend.show&&this.__legendReady(),this.config.tooltip&&this.config.tooltip.show&&this.__tooltipReady()),this._brushReady()},__legendReady:function(){function t(t){for(var e,i=a.series,n=0;e=i[n++];)if(e.name==t)return e}var i,n,r,a=this,o=a.id;this.on("legendMouseenter.line",function(s){i=a.main.selectAll(".xc-line-use").data([a]),n=a.main.selectAll(".xc-line-area-use").data([a]),r=a.main.selectAll(".xc-circle-use").data([a]),i.enter().append("use").attr("class","xc-line-use").attr("clip-path","url(#xc-clip-main-path)"),n.enter().append("use").attr("class","xc-line-area-use").attr("clip-path","url(#xc-clip-main-path)"),r.enter().append("use").attr("class","xc-circle-use").attr("clip-path","url(#xc-clip-main-path)");var l=t(s);if(l){var c="#xc-line-path-id"+o+"-"+l.idx,h="#xc-line-area-path-id"+o+"-"+l.idx,u="#xc-circle-group-id"+o+"-"+l.idx;i.attr("xlink:href",c),n.attr("xlink:href",h),r.attr("xlink:href",u),e.select(c).attr("stroke-width",l.lineStyle.width+1)}}),this.on("legendMouseleave.line",function(a){var s=t(a);if(s){var l="#xc-line-path-id"+o+"-"+s.idx,c=("#xc-line-area-path-id"+o+"-"+s.idx,"#xc-circle-group-id"+o+"-"+s.idx);i.attr("xlink:href",""),n.attr("xlink:href",""),r.attr("xlink:href",""),e.select(l).attr("stroke",s.color).attr("stroke-width",s.lineStyle.width),e.select(c).attr("fill",s.color)}}),this.on("legendClick.line",function(t){var e=a.config.series,i=a.config.animation;a.init(a.messageCenter,a.config,a.type,e),a.render(i.animationEase,i.animationTime)})},__tooltipReady:function(){var t=this;if(this.config.tooltip&&this.config.tooltip.show!==!1)if("axis"===this.config.tooltip.trigger||void 0===this.config.tooltip.trigger)this.on("tooltipSectionChange.line",function(e,i,n){var r="",a=t.series;if(t.timeModel)t.main.selectAll(".xc-tooltip-circle").remove(),t.series.forEach(function(i){var n=i.data[e];t.main.append("circle").datum(n).attr("class","xc-tooltip-circle").attr("r",function(t){return t._serie.lineStyle.radius}).attr("cx",function(t){return t._serie.xScale(t.x)}).attr("cy",function(t){return t._serie.yScale(t.y)}).attr("fill",function(t){return t._serie.color})});else{t.circle.style("display",function(){if(!this.circleDisplay)return"none"}).classed("xc-tooltip-circle",!1),t.circle.attr("r",function(){return this.circleRadius});var o=t.circleGroup.selectAll("circle:nth-child("+(e+1)+")");o.style("display",function(){if(!this.circleDisplay)return"block"}).classed("xc-tooltip-circle",!0).attr("r",function(){return 1.8*this.circleRadius})}a.forEach(function(t){if(t.show!==!1){var i=void 0===t.data[e]?"":t.data[e].value,a=t.formatter||n||c;r+=a(t.name,i)}}),i(r)}),this.on("tooltipHidden",function(){t.timeModel?t.main.selectAll(".xc-tooltip-circle").remove():t.circle.style("display",function(){if(!this.circleDisplay)return"none"}).classed("xc-tooltip-circle",!1)});else if(t.mobileMode)t.mobileReady();else{var e=t.messageCenter.components.tooltip;t.circle.on("mouseenter",n(t)),t.circle.on("mouseleave",function(){t.circle.attr("r",function(){return this.circleRadius}),e.hiddenTooltip()})}},_brushReady:function(){this.on("brushChange.line",function(t){this.render(e.easeLinear,0)}.bind(this))}}),i.tooltipTriggerItem=n}(e,t),function(t,e){var i=(t.utils,t.charts),n=i.line;n.prototype.extend({mobileReady:function(){this.circle.on("touchstart",n.tooltipTriggerItem(this))}})}(e,t),function(t,e){function i(t,e){A.call(this,t,e,"radar")}function n(){this.radarConfig=S.merage(w(),this.radarConfig);var t=this.radarConfig.center;"string"==typeof t[0]&&(t[0]=.01*parseFloat(t[0])*this.width),"string"==typeof t[1]&&(t[1]=.01*parseFloat(t[1])*this.height),"string"==typeof this.radarConfig.radius&&(this.radarConfig.radius=.01*parseFloat(this.radarConfig.radius)*this.width);var e=this.width<this.height?this.width:this.height;2*this.radarConfig.radius+20>e&&(this.radarConfig.radius=(e-20)/2)}function r(){this.radarConfig.total=this.radarConfig.data[0].value.length;for(var t=2*Math.PI/this.radarConfig.total,e=[],i=this.radarConfig.levels;i>0;i--){for(var n="",r=[],a=this.radarConfig.radius/this.radarConfig.levels*i,o=0;o<this.radarConfig.total;o++){var s=a*Math.sin(o*t),l=a*Math.cos(o*t);n+=s+","+l+" ",r.push({x:s,y:l})}e.push({webString:n,webPoints:r})}return e}function a(){for(var t=[],e=0;e<this.radarConfig.data.length;e++){for(var i=this.radarConfig.data[e],n=this.radarConfig.indicator[e].max,r=this.radarConfig.indicator[e].min,a="",o=[],s=0;s<i.value.length;s++){var l=this.polygonWebs[0].webPoints[s].x*i.value[s]/(n-r),c=this.polygonWebs[0].webPoints[s].y*i.value[s]/(n-r);a+=l+","+c+" ",o.push({x:l,y:c,originalData:i})}t.push({areaString:a,areaPoints:o,originalData:i,isShow:!0})}return t}function o(){for(var t=[],e=this.radarConfig.radius+20,i=0;i<this.radarConfig.total;i++)t.push({x:e/this.radarConfig.radius*this.polygonWebs[0].webPoints[i].x,y:e/this.radarConfig.radius*this.polygonWebs[0].webPoints[i].y+8});return t}function s(){for(var t=this.polygonWebs[0].webPoints,e=[],i=t.length,n=0;n<i;n++){var r=0==n?t[i-1]:t[n-1],a=t[n],o=t[(n+1)%i],s="0,0",l=[{x:0,y:0}];s+=" "+(r.x+a.x)/2+","+(r.y+a.y)/2,l.push({x:(r.x+a.x)/2,y:(r.y+a.y)/2}),s+=" "+a.x+","+a.y,l.push({x:a.x,y:a.y}),s+=" "+(a.x+o.x)/2+","+(a.y+o.y)/2,l.push({x:(a.x+o.x)/2,y:(a.y+o.y)/2}),e.push({pointsStr:s,points:l,index:n})}return e}function l(){var t=this.main.selectAll(".xc-radar").data([1]);return t=t.enter().append("g").classed("xc-radar",!0).merge(t),t.attr("transform","translate("+this.radarConfig.center[0]+","+this.radarConfig.center[1]+")"),t}function c(){var t=this.radar.selectAll(".xc-radar-webs").data([1]);t=t.enter().append("g").classed("xc-radar-webs",!0).merge(t);var e=t.selectAll(".xc-radar-web").data(this.polygonWebs);return e=e.enter().append("polygon").classed("xc-radar-web",!0).merge(e),e.attr("points",function(t){return t.webString}),e}function h(){var t=this.radar.selectAll(".xc-radar-lines").data([1]);t=t.enter().append("g").classed("xc-radar-lines",!0).merge(t);var e=t.selectAll(".xc-radar-line").data(this.polygonWebs[0].webPoints);return e=e.enter().append("line").classed("xc-radar-line",!0).merge(e),e.attr("x1",0).attr("y1",0).attr("x2",function(t){return t.x}).attr("y2",function(t){return t.y}),e}function u(t,e){var i=this,n=this.radar.selectAll(".xc-radar-areas").data([1]);n=n.enter().append("g").classed("xc-radar-areas",!0).merge(n);var r=n.selectAll(".xc-radar-area").data(this.areas);r=r.enter().append("g").attr("class",function(t,e){return"xc-radar-area xc-radar-area"+t.originalData.idx}).merge(r);var a=r.selectAll("polygon").data(function(t){return[t]});a=a.enter().append("polygon").attr("points",function(t){return Array.apply(0,Array(i.radarConfig.total)).map(function(){return"0,0"}).join(" ")}).style("stroke",function(t){return t.originalData.color||(t.originalData.color=i.getColor(t.originalData.idx)),t.originalData.color}).style("fill",function(t){return i.radarConfig.fill?t.originalData.color:""}).merge(a),a.transition().duration(e).ease(t).attr("points",function(t){return t.areaString});var o=r.selectAll(".xc-radar-area-point").data(function(t){return t.areaPoints});return o=o.enter().append("circle").classed("xc-radar-area-point",!0).attr("cx",0).attr("cy",0).merge(o),o.style("stroke",function(t){return t.originalData.color}),o.transition().duration(e).ease(t).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),r}function d(){var t=this,e=this.radar.selectAll(".xc-radar-texts").data([1]);e=e.enter().append("g").classed("xc-radar-texts",!0).merge(e);var i=e.selectAll(".xc-radar-text").data(this.textPoints);return i=i.enter().append("text").classed("xc-radar-text",!0).text(function(e,i){return t.radarConfig.indicator[i].text}).attr("text-anchor","middle").merge(i),i.attr("x",function(t){return t.x}).attr("y",function(t){return t.y}),i}function f(){var t=this.radar.selectAll(".xc-radar-coverPolygons").data([1]);t=t.enter().append("g").classed("xc-radar-coverPolygons",!0).merge(t);var e=t.selectAll(".xc-radar-coverPolygon").data(this.coverPolygons);return e=e.enter().append("polygon").classed("xc-radar-coverPolygon",!0).merge(e),e.attr("points",function(t){return t.pointsStr}),e}function p(){g.apply(this),x.apply(this),m.apply(this)}function g(){var t=this,i=this.areas;this.on("legendMouseenter.radar",function(n){for(var r={},a=0;a<i.length;a++)if(n==i[a].originalData.name){r=i[a];break}for(var a=0;a<t.areaList._groups[0].length;a++){var o=e.select(t.areaList._groups[0][a]);if(o.datum()==r){o.selectAll(".xc-radar-area-point").style("stroke-width",5);break}}})}function x(){var t=this,i=this.areas;this.on("legendMouseleave.radar",function(n){for(var r={},a=0;a<i.length;a++)if(n==i[a].originalData.name){r=i[a];break}for(var a=0;a<t.areaList._groups[0].length;a++){var o=e.select(t.areaList._groups[0][a]);if(o.datum()==r){o.selectAll(".xc-radar-area-point").style("stroke-width",3);break}}})}function m(){var t=this;this.on("legendClick.radar",function(e){t._reRenderAreas(e)})}function y(){v.apply(this),b.apply(this)}function v(){var t=this;this.coverPolygonList.on("mousemove.radar",function(){var i=e.select(this).datum().index;t._showTooltip(i,this)})}function b(){var t=this;this.coverPolygonList.on("mouseout.radar",function(){var e=t.messageCenter.components.tooltip;e.hiddenTooltip();var i=t.areaList.selectAll(".xc-radar-area-point");i.style("stroke-width",3),t.lineList.classed("xc-radar-tooltip-line",!1)})}function C(t,e){var i="";i+="<h3>"+t+"</h3>";for(var n=0;n<e.length;n++)i+="<div>"+e[n].name+"："+e[n].value+"</div>";return i}function w(){var t={type:"radar",levels:4,radius:"15%",fill:!1,center:["50%","50%"],indicator:[{max:100,min:0}],data:[{}]};return t}var S=t.utils,A=t.charts.Chart;t.charts.extend({radar:i}),S.inherits(i,A),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,l){for(var c=0,h=l.length;c<h;c++)if("radar"===l[c].type){this.radarConfig=S.copy(l[c],!0);break}n.apply(this),this.polygonWebs=r.apply(this),this.areas=a.apply(this),this.textPoints=o.apply(this),this.coverPolygons=s.apply(this)},render:function(t,e){this.radar=l.apply(this),this.webList=c.apply(this),this.lineList=h.apply(this),this.areaList=u.apply(this,[t,e]),this.textList=d.apply(this),this.coverPolygonList=f.apply(this)},ready:function(){this.mobileMode?this.mobileReady():(this.config.legend&&this.config.legend.show&&p.apply(this),this.config.tooltip&&this.config.tooltip.show&&y.apply(this))},_reRenderAreas:function(t){for(var i=0;i<this.areas.length;i++)this.areas[i].isShow=!1;for(var i=0;i<t.length;i++)for(var n=0;n<this.areas.length;n++)if(t[i]==this.areas[n].originalData.name){this.areas[n].isShow=!0;break}for(var i=0;i<this.areas.length;i++)e.select(this.areaList._groups[0][i]).classed("hidden",!this.areas[i].isShow)},_showTooltip:function(t,i){var n=this.messageCenter.components.tooltip,r=n.tooltipConfig.formatter,a=this.radarConfig.formatter,o=a||r||C,s=e.mouse(this.svg.node());s=[s[0]+40,s[1]+40];for(var l=this.radarConfig.indicator[t].text,c=[],h=0;h<this.radarConfig.data.length;h++)this.areas[h].isShow&&c.push({name:this.radarConfig.data[h].name,value:this.radarConfig.data[h].value[t]});n.setTooltipHtml(o(l,c)),n.showTooltip(),n.setPosition(s);for(var u=this.areaList.selectAll(".xc-radar-area-point"),h=0;h<u.length;h++){var d=u[h];e.select(d[t]).style("stroke-width",5)}this.lineList.classed("xc-radar-tooltip-line",!1),e.select(this.lineList._groups[0][t]).classed("xc-radar-tooltip-line",!0)}})}(e,t),function(t,e){function i(){n.apply(this)}function n(){var t=this;this.on("legendClick.radar",function(e){t._reRenderAreas(e),t.messageCenter.components.tooltip.hiddenTooltip()})}function r(){a.apply(this)}function a(){var t=this;this.coverPolygonList.on("touchstart.radar",function(){var i=e.select(this).datum().index;t.areaList.selectAll(".xc-radar-area-point").style("stroke-width",3),t._showTooltip(i,this)})}var o=(t.utils,t.charts),s=o.radar;s.prototype.extend({mobileReady:function(){this.config.legend&&this.config.legend.show&&i.apply(this),this.config.tooltip&&this.config.tooltip.show&&r.apply(this)}})}(e,t),function(t,e){function i(t,e){w.call(this,t,e,"bar")}function n(){var t=this,e=this.bar.selectAll(".xc-bar-bg-rect").data(function(){return t.backgroundRectList});e=e.enter("rect").append("rect").classed("xc-bar-bg-rect",!0).merge(e),e.attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("fill",function(t){return t.fill}).attr("opacity",function(t){return t.opacity})}function r(){var t=this.rectWrapperList.selectAll(".xc-bar-text").data(function(t){return t.rectsData});return t=t.enter().append("text").classed("xc-bar-text",!0).merge(t),t.attr("x",function(t){return t.text.x}).attr("y",function(t){return t.text.y}).attr("text-anchor","middle").attr("fill",function(t){return t.text.color}).attr("font-size",function(t){return t.text.fontSize}).attr("opacity",function(t){return t.text.show===!1?0:1}).text(""),this.on("drawBarEnd.barText",function(){t.text(function(t){return t.text.show===!1?"":t.text.value})}),t}function a(t,e){var i=C.merage(v(),e);return C.merage(i,t)}function o(){var t=this.globalBarConfig.paddingOuter,e=this.globalBarConfig.paddingInner;this.barXScale.paddingOuter(t),this.barXScale.paddingInner(e);var i=this.barXScale.bandwidth(),n=this.barXScale.domain().length,r=this.barXScale.range(),a=this.barYScale.range(),o=2;this.xRange=r[1]-r[0],this.yRange=a[0]-a[1];var s=this.barXScale.step(),l=s*t;this.outWidth=l;for(var c=(this.xRange-i*n)/21,h=this.globalBarConfig.barGap,u=Object.keys(this.barSeries),d=u.length,f=(i-(d+1)*h)/d,p=[],g=c,x=[],m=0,y=0;y<n;y++){var v=[],b=[],C=h;x.push({x:m,y:0,height:this.yRange,width:s,opacity:y%2===0?this.globalBarConfig.background.oddOpacity:this.globalBarConfig.background.evenOpacity,fill:y%2===0?this.globalBarConfig.background.oddColor:this.globalBarConfig.background.evenColor}),0===y&&(x[y].width+=l,x[y].x-=l),y===n-1&&(x[y].width+=l),m+=s;for(var w=0;w<d;w++){for(var S=u[w],A=this.barSeries[S],k=[],_=this.yRange,L=!0,R=0;R<A.length;R++){var T=A[R],P=T.labelList[y],F=parseFloat(T.data[y]);F!==F&&(F=0);var E={x:C,width:f>0?f:0,height:this.yRange-this.barYScale(F),color:T.color,idx:T.idx};if(P&&E.height<5&&(E.height=5),E.y=_-E.height,E.y<0&&(E.height+=E.y,E.y=0),E.height>0&&L===!1?E.height-=o:E.height>0&&(L=!1),E.text={x:E.x+E.width/2,y:E.y+E.height/2+T.textStyle.fontSize/2,value:T.textFormat(T.data[y]),color:T.textStyle.color,fontSize:T.textStyle.fontSize,show:!0},E.text.show=T.textShow,E.text.fontSize+2>=E.height&&(E.text.show=!1),0===E.height&&1===A.length&&(E.text.show=!0,E.text.y-=E.text.fontSize/1.5),P){var W=5,M=14,z=12,D=P.value.length*z+10,X={x:E.x,y:E.y,height:M,width:D,color:P.color,text:{value:P.value,x:E.x+D/2,y:E.y+M/2+z/2-2,fontSize:z}};E.height/2<E.text.fontSize/2+X.height?(X.showValue=!1,X.height=W):X.showValue=!0,D>E.width&&(X.showValue=!1,X.width=E.width/2),b.push(X)}_=E.y,k.push(E)}v=v.concat(k),C+=f+h}var H={x:g,y:0,rectsData:v,labelData:b};p.push(H),g+=i}return this.backgroundRectList=x,p}function s(){for(var t=this.barXScale.bandwidth(),e=this.globalBarConfig.barGap,i=2,n={},r=0,a=0;a<this.seriesList.length;a++)this.seriesList[a].isShow&&(n[this.seriesList[a].stack]=!0);r=Object.keys(n).length;for(var o=(t-(r+1)*e)/r,a=0;a<this.rectsData.length;a++){for(var s=e,l=[],c=Object.keys(this.barSeries),h=[],u=0;u<c.length;u++){for(var d=this.barSeries[c[u]],f=[],p=this.yRange,g=!0,x=0;x<d.length;x++){var m=d[x],y=m.labelList[a],v=parseFloat(m.data[a]);if(v!==v&&(v=0),m.isShow){var b={x:s,width:o,height:this.yRange-this.barYScale(v),color:m.color,idx:m.idx};if(y&&b.height<5&&(b.height=5),b.y=p-b.height,b.y<0&&(b.height+=b.y,b.y=0),b.height>0&&g===!1?b.height-=i:b.height>0&&(g=!1),b.text={x:b.x+b.width/2,y:b.y+b.height/2+m.textStyle.fontSize/2,value:m.textFormat(m.data[a]),color:m.textStyle.color,fontSize:m.textStyle.fontSize,show:!0},b.text={x:b.x+b.width/2,y:b.y+b.height/2+m.textStyle.fontSize/2,value:m.textFormat(m.data[a]),color:m.textStyle.color,fontSize:m.textStyle.fontSize,show:!0},b.text.show=m.textShow,b.text.fontSize+2>=b.height&&(b.text.show=!1),0===b.height&&1===d.length&&(b.text.show=!0,b.text.y-=b.text.fontSize/1.5),y){var C=5,w=14,S=12,A=y.value.length*S+10,k={x:b.x,y:b.y,height:w,width:A,color:y.color,text:{value:y.value,x:b.x+A/2,y:b.y+w/2+S/2-2,fontSize:S}};b.height/2<b.text.fontSize/2+k.height?(k.showValue=!1,k.height=C):k.showValue=!0,A>b.width&&(k.showValue=!1,k.width=b.width/2),l.push(k)}p=b.y,f.push(b)}else{var b={x:s,width:0,height:0,color:m.color,idx:m.idx};b.text={x:0,y:0,value:0,color:m.textStyle.color,fontSize:0,show:!1},b.y=p,f.push(b)}}for(var _=0,L=0,R=0;R<f.length;R++)if(f[R].width>0){_=f[R].width,L=e;break}s+=_+L,h=h.concat(f)}this.rectsData[a].rectsData=h,this.rectsData[a].labelData=l}}function l(){var t=this.rectWrapperList.selectAll(".xc-bar-label-rect").data(function(t){return t.labelData});t.exit().remove(),t=t.enter().append("rect").classed("xc-bar-label-rect",!0).merge(t),t.attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("fill","transparent");var e=this.rectWrapperList.selectAll(".xc-bar-label-text").data(function(t){return t.labelData});e.exit().remove(),e=e.enter().append("text").classed("xc-bar-label-text",!0).merge(e),e.attr("x",function(t){return t.text.x}).attr("y",function(t){return t.text.y}).attr("text-anchor","middle").attr("fill","#fff").attr("font-size",function(t){return t.text.fontSize}).text(""),this.on("drawBarEnd.barLabel",function(){e.text(function(t){return t.showValue===!1?"":t.text.value}),t.attr("fill",function(t){return t.color})})}function c(){var t=this,e=this.main.selectAll(".xc-bar").data([1]);return e=e.enter().append("g").classed("xc-bar",!0).attr("transform",function(){return"translate("+t.outWidth+",0)"}).merge(e)}function h(){var t=this.bar.selectAll(".xc-bar-rectWrapper").data(this.rectsData);return t=t.enter().append("g").classed("xc-bar-rectWrapper",!0).merge(t),t.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),t}function u(t,e){var i=this,n=this.rectWrapperList.selectAll(".xc-bar-rect").data(function(t){return t.rectsData});n=n.enter().append("rect").classed("xc-bar-rect",!0).attr("x",function(t){return t.x}).attr("y",this.yRange).attr("width",function(t){return t.width}).attr("height",0).attr("fill",function(t){return t.color}).attr("data-index",function(t){return t.idx}).merge(n);var r=n.transition().duration(e).ease(t).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){
return t.height}),a=!1;return r.on("end.bar",function(){a===!1?i.fire("drawBarEnd"):a=!0}),n}function d(){f.apply(this),p.apply(this),g.apply(this)}function f(){var t=this;this.on("legendMouseenter.bar",function(i){for(var n=0,r=0;r<t.seriesList.length;r++)if(t.seriesList[r].name==i){n=t.seriesList[r].idx;break}t.rectList._groups.forEach(function(t){t.forEach(function(t){t.__data__.idx===n&&e.select(t).attr("fill-opacity",.5)})})})}function p(){var t=this;this.on("legendMouseleave.bar",function(i){for(var n=0,r=0;r<t.seriesList.length;r++)if(t.seriesList[r].name==i){n=t.seriesList[r].idx;break}t.rectList._groups.forEach(function(t){t.forEach(function(t){t.__data__.idx===n&&e.select(t).attr("fill-opacity",null)})})})}function g(){var t=this;this.on("legendClick.bar",function(e){t._reRenderBars(e)})}function x(){"axis"==this.config.tooltip.trigger&&this._tooltipSectionChange()}function m(t,e){var i="";return i+="<div>"+t+"："+e+"</div>"}function y(t,e){e=e||{};for(var i=[],n=Object.keys(e),r=0;r<t.length;r++){i[r]=null;for(var a=0;a<n.length;a++){var o=e[n[a]];if(o.xAxis==t[r]){i[r]=o;break}}}return i}function v(){var t={type:"bar"};return t}function b(){var t={textShow:!1,textFormat:function(t,e){return t},textStyle:{fontSize:14,color:"#fff"},hoverOpacity:.5,barGap:10,legendShow:!0,paddingOuter:.05,paddingInner:0,background:{enable:!0,oddOpacity:.8,oddColor:"#eee",evenOpacity:.4,evenColor:"#eee"}};return t}var C=t.utils,w=t.charts.Chart;t.charts.extend({bar:i}),C.inherits(i,w),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,n){if(!this.barSeries){var r=C.merage(b(),this.config.bar);this.globalBarConfig=r;for(var l={},c=this.config.xAxis[0].data,h=[],u=0;u<n.length;u++)if("bar"==n[u].type){var d=a(n[u],r),f=d.stack||"%bar"+u;d.isShow=d.legendShow!==!1,d.labelList=y(c,d.label),d.stack=f,l[f]=l[f]||[],l[f].push(d),d.color=this.getColor(d.idx),h.push(d)}this.barSeries=l,this.seriesList=h}this.xAxisScale=t.xAxisScale,this.yAxisScale=t.yAxisScale;for(var u=0;u<this.xAxisScale.length;u++)if("barCategory"===this.xAxisScale[u].scaleType){this.barXScale=this.xAxisScale[u];break}this.barYScale=this.yAxisScale[0],this.rectsData=o.apply(this);for(var u=0;u<this.seriesList.length;u++)if(!this.seriesList[u].isShow){s.apply(this);break}},render:function(t,e){this.bar=c.apply(this),this.bgRect=n.apply(this),this.rectWrapperList=h.apply(this),this.rectList=u.apply(this,[t,e]),this.labelList=l.apply(this),this.textList=r.apply(this)},ready:function(){this.mobileMode?this.mobileReady():(this.config.legend&&this.config.legend.show&&d.apply(this),this.config.tooltip&&this.config.tooltip.show&&x.apply(this))},_reRenderBars:function(t){var e=this.config.animation;this.barYScale=this.messageCenter.yAxisScale[0];for(var i=Object.keys(this.barSeries),n=0;n<i.length;n++){var a=this.barSeries[i[n]];a.forEach(function(t){t.isShow=!1})}for(var n=0;n<t.length;n++)for(var o=0;o<this.seriesList.length;o++)if(t[n]==this.seriesList[o].name){this.seriesList[o].isShow=!0;break}s.apply(this),u.apply(this,[e.animationEase,e.animationTime]),l.apply(this),r.apply(this)},_tooltipSectionChange:function(){var t=this;this.on("tooltipSectionChange.bar",function(e,i,n){var r="";t.seriesList.forEach(function(t){if(t.isShow){var i=t.formatter||n||m;r+=i(t.name,t.data[e])}}),i(r)})}})}(e,t),function(t,e){function i(){n.apply(this)}function n(){var t=this;this.on("legendClick.bar",function(e){t._reRenderBars(e),t.messageCenter.components.tooltip.hiddenTooltip()})}function r(){"axis"==this.config.tooltip.trigger&&this._tooltipSectionChange()}var a=(t.utils,t.charts),o=a.bar;o.prototype.extend({mobileReady:function(){this.config.legend&&this.config.legend.show&&i.apply(this),this.config.tooltip&&this.config.tooltip.show&&r.apply(this)}})}(e,t),function(t,e){function i(t,e){S.call(this,t,e,"pie")}function n(){this.pieConfig=w.merage(C(),this.pieConfig);var t=this.pieConfig.center;"string"==typeof t[0]&&(t[0]=.01*parseInt(t[0])*this.width),"string"==typeof t[1]&&(t[1]=.01*parseInt(t[1])*this.height);var e;e=this.mobileMode&&this.pieConfig.mRadius.outerRadius?this.pieConfig.mRadius:this.pieConfig.radius,"string"==typeof e.innerRadius&&(e.innerRadius=.01*parseInt(e.innerRadius)*this.width),"string"==typeof e.outerRadius&&(e.outerRadius=.01*parseInt(e.outerRadius)*this.width),this.pieConfig.radius=e;var i=this.width<this.height?this.width:this.height;2*e.outerRadius>i&&(e.outerRadius=i/2),this.pieConfig.data.forEach(function(t){t.isShow=!0,t.initialValue=t.value})}function r(t){var i=e.pie().sort(null).value(function(t,e){return t.value}),n=i(t);return n}function a(t){var i=e.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius);return i}function o(t){var i=10,n=e.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius+i);return n}function s(t){var i=1.1,n=e.arc().innerRadius(t.outerRadius*i).outerRadius(t.outerRadius*i);return n}function l(){var t=this.main.selectAll(".xc-pie").data([1]);return t=t.enter().append("g").classed("xc-pie",!0).merge(t),t.attr("transform","translate("+this.pieConfig.center[0]+","+this.pieConfig.center[1]+")"),t}function c(t,i){var n=this,r=this.pieWrapper.selectAll(".xc-pie-arcs").data([1]);r=r.enter().append("g").classed("xc-pie-arcs",!0).merge(r);var a=r.selectAll(".xc-pie-arc").data(this.pieData);return a=a.enter().append("path").classed("xc-pie-arc",!0).style("fill",function(t){return t.data.color||(t.data.color=n.getColor(t.data.idx)),t.data.color}).merge(a),a.transition().duration(i).ease(t).attrTween("d",function(t){this._current=this._current||{startAngle:0,endAngle:0};var i=e.interpolate(this._current,t);return this._current=i(1),function(t){return n.arcFunc(i(t))}}),a}function h(t,e){var i=this,n=this.pieWrapper.selectAll(".xc-pie-texts").data([1]);n=n.enter().append("g").classed("xc-pie-texts",!0).merge(n);var r=n.selectAll(".xc-pie-text").data(this.pieData);r=r.enter().append("text").classed("xc-pie-text",!0).attr("dy","0.35em").attr("fill",function(t){return t.data.color}).text(function(t){var e=i.pieConfig.labels.formatter||v;return e(t.data.name,t.data.value)}).merge(r),r.transition().duration(e).ease(t).attr("transform",function(t){var e=i.textArcFunc.centroid(t);return e[0]=i.pieConfig.radius.outerRadius*(b(t)<Math.PI?1.2:-1.2),"translate("+e+")"}).style("display",function(t){return t.data.isShow?null:"none"}).style("text-anchor",function(t){return b(t)<Math.PI?"start":"end"})}function u(t,i){var n=this,r=e.arc().innerRadius(1.05*this.pieConfig.radius.outerRadius).outerRadius(1.05*this.pieConfig.radius.outerRadius),a=this.pieWrapper.selectAll(".xc-pie-textLines").data([1]);a=a.enter().append("g").classed("xc-pie-textLines",!0).merge(a);var o=a.selectAll(".xc-pie-textLine").data(this.pieData);o=o.enter().append("polyline").classed("xc-pie-textLine",!0).attr("points",function(t){return[r.centroid(t),r.centroid(t),r.centroid(t)]}).merge(o),o.transition().duration(i).ease(t).attr("points",function(t){var e=n.textArcFunc.centroid(t);return e[0]=n.pieConfig.radius.outerRadius*(b(t)<Math.PI?1.2:-1.2),[r.centroid(t),n.textArcFunc.centroid(t),e]}).style("display",function(t){return t.data.isShow?null:"none"})}function d(){f.apply(this),p.apply(this),g.apply(this)}function f(){var t=this;this.on("legendMouseenter.pie",function(i){for(var n=0;n<t.arcList._groups[0].length;n++){var r=e.select(t.arcList._groups[0][n]);if(r.datum().data.name==i){r.attr("d",function(e){return t.bigArcFunc(e)});break}}})}function p(){var t=this;this.on("legendMouseleave.pie",function(i){for(var n=0;n<t.arcList._groups[0].length;n++){var r=e.select(t.arcList._groups[0][n]);if(r.datum().data.name==i){r.attr("d",function(e){return t.arcFunc(e)});break}}})}function g(){var t=this;this.on("legendClick.pie",function(e){t._reRenderArcs(e)})}function x(){m.apply(this),y.apply(this)}function m(){var t=this,i=this.messageCenter.components.tooltip;this.arcList.on("mousemove.pie",function(){var n=e.select(this).datum(),r=e.mouse(t.svg.node());r=[r[0]+10,r[1]+10];var a=i.tooltipConfig.formatter,o=t.pieConfig.formatter,s=o||a||t._defaultTooltipFormatter;i.setTooltipHtml(s(n.data.name,n.data.value)),i.showTooltip(),i.setPosition(r),e.select(this).attr("d",function(e){return t.bigArcFunc(e)})})}function y(){var t=this,i=this.messageCenter.components.tooltip;this.arcList.on("mouseout.pie",function(){i.hiddenTooltip(),e.select(this).attr("d",function(e){return t.arcFunc(e)})})}function v(t){return t}function b(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function C(){var t={type:"pie",center:["50%","50%"],radius:{outerRadius:"30%",innerRadius:0},mRadius:{innerRadius:0},labels:{enable:!1,formatter:v,mobileFormatter:function(t,e,i){return t}},data:[{}]};return t}var w=t.utils,S=t.charts.Chart;t.charts.extend({pie:i}),w.inherits(i,S),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,l){for(var c=0,h=l.length;c<h;c++)if("pie"===l[c].type){this.pieConfig=w.copy(l[c],!0);break}n.apply(this),this.pieData=r(this.pieConfig.data),this.arcFunc=a(this.pieConfig.radius),this.bigArcFunc=o(this.pieConfig.radius),this.textArcFunc=s(this.pieConfig.radius)},render:function(t,e){this.pieWrapper=l.apply(this),this.arcList=c.apply(this,[t,e]),this.mobileMode?this.mobileRender(t,e):this.pieConfig.labels&&this.pieConfig.labels.enable&&(this.textList=h.apply(this,[t,e]),this.textLineList=u.apply(this,[t,e]))},ready:function(){this.mobileMode?this.mobileReady():(this.config.legend&&this.config.legend.show&&d.apply(this),this.config.tooltip&&this.config.tooltip.show&&x.apply(this))},_reRenderArcs:function(t){var e=this.config.animation;if(t.length){this.pieConfig.data.forEach(function(t){t.isShow=!1,t.value=0});for(var i=0;i<t.length;i++)for(var n=t[i],a=0;a<this.pieConfig.data.length;a++)if(this.pieConfig.data[a].name==n){this.pieConfig.data[a].isShow=!0,this.pieConfig.data[a].value=this.pieConfig.data[a].initialValue;break}this.pieData=r(this.pieConfig.data)}else this.pieData.forEach(function(t){t.startAngle=0,t.endAngle=0,t.data.isShow=!1});if(c.apply(this,[e.animationEase,e.animationTime]),this.pieConfig.labels&&this.pieConfig.labels.enable){if(this.mobileMode)return void this.__renderMobileText(e.animationEase,e.animationTime);h.apply(this,[e.animationEase,e.animationTime]),u.apply(this,[e.animationEase,e.animationTime])}},_defaultTooltipFormatter:function(t,e){return"<div>"+t+"："+e+"</div>"}})}(e,t),function(t,e){function i(){n.apply(this)}function n(){var t=this;this.on("legendClick.pie",function(e){t._reRenderArcs(e),t.messageCenter.components.tooltip.hiddenTooltip()})}function r(){a.apply(this)}function a(){var t=this,i=this.messageCenter.components.tooltip;this.arcList.on("touchstart.pie",function(){var n=e.select(this).datum(),r=t.bigArcFunc(n);if(r===e.select(this).attr("d"))e.select(this).attr("d",function(e){return t.arcFunc(e)}),i.hiddenTooltip();else{t.arcList.attr("d",function(e){return t.arcFunc(e)}),e.select(this).attr("d",function(e){return t.bigArcFunc(e)});var a=e.mouse(t.svg.node());a=[a[0]+10,a[1]+10];var o=i.tooltipConfig.formatter,s=t.pieConfig.formatter,l=s||o||t._defaultTooltipFormatter;i.setTooltipHtml(l(n.data.name,n.data.value)),i.showTooltip(),i.setPosition(a)}})}var o=(t.utils,t.charts),s=o.pie;s.prototype.extend({mobileRender:function(t,e){this.pieConfig.labels&&this.pieConfig.labels.enable&&(this.textList=this.__renderMobileText(t,e))},mobileReady:function(){this.config.legend&&this.config.legend.show&&i.apply(this),this.config.tooltip&&this.config.tooltip.show&&r.apply(this)},__renderMobileText:function(t,e){var i=this,n=this.pieWrapper.selectAll(".xc-pie-m-texts").data([1]);n=n.enter().append("g").classed("xc-pie-m-texts",!0).merge(n);var r=n.selectAll(".xc-pie-m-text").data(this.pieData);r=r.enter().append("text").classed("xc-pie-m-text",!0).attr("dy",".35em").attr("fill",function(t){return"#fff"}).text(function(t){return i.pieConfig.labels.mobileFormatter(t.data.name)}).merge(r),r.transition().duration(e).ease(t).attr("transform",function(t){var e=i.arcFunc.centroid(t);return"translate("+e+")"}).style("display",function(t){return t.data.isShow?null:"none"}).style("text-anchor",function(t){return"middle"})}})}(e,t),function(t,e){function i(t,e){f.call(this,t,e,"funnel")}function n(t,e){return t.forEach(function(t){"funnel"==t.type&&t.data.forEach(function(t){r(t.name,e)?t.show=!0:t.show=!1})}),t}function r(t,e){for(var i,n=0;i=e[n++];)if(t==i)return!0;return!1}function a(t){var e="M";return e+=t[0],e+="L"+t[1],e+="L"+t[2],e+="L"+t[3]}function o(t,e){for(var i,n=[],r=0;i=t[r++];){if("funnel"!=i.type)return;i=d.merage(u(),i),l(i,e),c(i,e),i.funnelPath=s(i),i.data.forEach(function(t,e){t.idx=null==t.idx?e:t.idx,t._serie=i,t.pathArr=i.funnelPath(e);var n=(t.pathArr[0][0]+t.pathArr[1][0])/2,r=(t.pathArr[0][1]+t.pathArr[2][1])/2;t.labelPosition=[n,r],t.labelWidth=t.sectionWidth/2+30}),n.push(i)}return n}function s(t){var i=t.width,n=t.height,r=t.data,a=t.sort;r.sort(function(t,e){var i=t.value-e.value;return"top"==a?i:-i});var o=r.length,s=-(1/0);r.forEach(function(t){0==t.show&&o--,s=e.max([s,parseFloat(t.value)])});var l=n/o,c="top"==a?1:0,h=[];if(r.forEach(function(t,e){if(t.maxValue=s,t.percentage=parseFloat(t.value)/s,0==t.show)return void(h[e]=void 0);var n=t.percentage*i;t.sectionWidth=n;var r=(i-n)/2;h[e]=[],h[e][0]=[r,l*c],h[e][1]=[r+n,l*c],c++}),"top"==a){var u=[i/2,0];h.unshift([u,u])}else{var d=[i/2,l*c];h.push([d,d])}for(var f=0,p=h.length;f<p;f++){var g=h[f];if(void 0==g)for(var x=1;void 0===h[f];)"top"==a?h[f]=h[f-x]:h[f]=h[f+x],x++}return function(t){(t<0||t>=r.length)&&console.error("内部代码错误,漏斗图获取区块%d，最大值为%d",t,r.length);var e=[];return e[0]=h[t][0],e[1]=h[t][1],e[2]=h[t+1][1],e[3]=h[t+1][0],e}}function l(t,e){var i=e.width,n=e.height,r=t.size,a=r[0];if("string"==typeof a)if("%"===a.substr(-1)){var o=parseFloat(a)/100;a=o*i}else"px"==a.substr(-2)?a=parseFloat(a):(a=parseFloat(a),isNaN(a)&&console.error("name:"+t.name+" size[0] not support"));else"number"!=typeof a&&console.error("name:"+t.name+" size[0] not support");var s=r[1];if("string"==typeof s)if("%"===s.substr(-1)){var o=parseFloat(s)/100;s=o*n}else"px"==s.substr(-2)?s=parseFloat(s):(s=parseFloat(s),isNaN(s)&&console.error("name:"+t.name+" size[1] not support"));else"number"!=typeof s&&console.error("name:"+t.name+" size[1] not support");t.width=a,t.height=s}function c(t,e){var i=e.width,n=e.height,r=t.x,a=t.y,o=0,s=0;"center"==r?o=(i-t.width)/2:"right"==r?o=i-t.width:"%"==r.substr(-1)?o=parseFloat(r)/100*i:(r=parseFloat(r),isNaN(r)?console.error("name:"+t.name+" serie.x not support"):o=r),"middle"==a?s=(n-t.height)/2:"%"==a.substr(-1)?s=parseFloat(a)/100*n:(a=parseFloat(a),isNaN(a)?console.error("name:"+t.name+" serie.y not support"):s=a),t.xOffset=o,t.yOffset=s}function h(t,e,i){return"<p>"+t+":&nbsp;"+e+" 占比:"+i+"%</p>"}function u(){var t={name:"漏斗图",type:"funnel",sort:"down",size:["50%","50%"],x:"center",y:"middle",data:[],itemStyle:{opacity:.5}};return t}var d=t.utils,f=t.charts.Chart;t.charts.extend({funnel:i}),d.inherits(i,f),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,n){var r=this;r.series=o(n,r)},render:function(t,i){var n=this,r=n.config.animation,o=n.main.selectAll(".xc-funnel-group").data(n.series);o=o.enter().append("g").attr("class","xc-funnel-group").merge(o),o.exit().remove(),o.attr("transform",function(t){return"translate("+t.xOffset+","+t.yOffset+")"});var s=o.selectAll(".xc-funnel-section").data(function(t){return t.data});s=s.enter().append("path").attr("class","xc-funnel-section").merge(s),s.attr("fill",function(t){return n.getColor(t.idx)}).transition().ease(t).duration(i).attrTween("d",function(t){if(void 0===this.pathArr){var i=d.copy(t.pathArr,!0);i[2][1]=.95*i[2][1],i[3][1]=.95*i[3][1],this.pathArr=i}var n=e.interpolate(this.pathArr,t.pathArr);return this.pathArr=t.pathArr,function(t){return a(n(t))}});var l=o.selectAll(".xc-funnel-label").data(function(t){return t.data}),c="opacity "+r.animationTime+"ms linear";l=l.enter().append("g").attr("class","xc-funnel-label").style("transition",c).merge(l),l.exit().remove(),l.attr("opacity",function(t){return 0==t.show?0:1}).transition().ease(t).duration(i).attrTween("transform",function(t){void 0===this.labelPosition&&(this.labelPosition=[1.1*t.labelPosition[0],t.labelPosition[1]]);var i=e.interpolate(this.labelPosition,t.labelPosition);return this.labelPosition=t.labelPosition,function(t){return"translate("+i(t)+")"}});var h=l.selectAll(".xc-funnel-label-line").data(function(t){return 0!=t.show?[t]:[]});h=h.enter().append("path").attr("class","xc-funnel-label-line").merge(h),h.attr("d",function(t){return"M0,0 L"+t.labelWidth+",0"}).attr("stroke",function(t){return n.getColor(t.idx)});var u=l.selectAll(".xc-funnel-label-text").data(function(t){return 0!=t.show?[t]:[]});u=u.enter().append("text").attr("class","xc-funnel-label-text").merge(u),u.text(function(t){return t.name}).attr("font-size",14).attr("x",function(t){return t.labelWidth+5}).attr("y","0.2em"),n.funnelSection=s},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){var t=this;t.on("legendMouseenter.funnel",function(e){t.funnelSection.attr("opacity",function(t){var i=1;return t.name==e&&(i=t._serie.itemStyle.opacity),i})}),t.on("legendMouseleave.funnel",function(){t.funnelSection.attr("opacity",1)}),t.on("legendClick.funnel",function(e){var i=n(t.config.series,e),r=t.config.animation;t.init(t.series,t.config,t.type,i),t.render(r.animationEase,r.animationTime)})},__tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"!=this.config.tooltip.trigger){var t=this,i=t.messageCenter.components.tooltip,n=i.tooltipConfig.formatter;t.mobileMode?t.mobileReady():(t.funnelSection.on("mousemove.funnel",function(t){var r=e.event,a=r.layerX||r.offsetX,o=r.layerY||r.offsetY,s=t._serie.formatter||n||h,l="<p>"+t._serie.name+"</p>";i.setTooltipHtml(l+s(t.name,t.value,(100*t.percentage).toFixed(1))),i.setPosition([a,o])}),t.funnelSection.on("mouseenter.funnel",function(t){e.select(this).attr("opacity",t._serie.itemStyle.opacity),i.showTooltip()}),t.funnelSection.on("mouseleave.funnel",function(){e.select(this).attr("opacity",1),i.hiddenTooltip()}))}}}),i.defaultFormatter=h}(e,t),function(t,e){function i(t){var i=t.messageCenter.components.tooltip,n=i.tooltipConfig.formatter;return function(r){t.funnelSection.attr("opacity",1),e.select(this).attr("opacity",r._serie.itemStyle.opacity),i.showTooltip();var o=r._serie.formatter||n||a,s="<p>"+r._serie.name+"</p>";i.setTooltipHtml(s+o(r.name,r.value,(100*r.percentage).toFixed(1)));var l=e.mouse(t.svg.node());i.setPosition(l)}}var n=(t.utils,t.charts),r=n.funnel;r.prototype.extend({mobileReady:function(){this.funnelSection.on("touchstart.funnel",i(this))}});var a=r.defaultFormatter}(e,t),function(t,e){function i(t,e){c.call(this,t,e,"scatter")}function n(t,e){for(var i,n=0;i=t[n++];)if(i.name==e)return i}function r(t,e,i){for(var n,r=[],a=0;n=t[a++];)if("scatter"==n.type){n=l.merage(s(),n);var o=n.size;n.idx=null==n.idx?a-1:n.idx,n.xScale=e[n.xAxisIndex],n.yScale=i[n.yAxisIndex],n.data=n.data.map(function(t,e){var i="function"==typeof o?o(t):o,r={};return r.data=t,r.radius=i,r._serie=n,r}),r.push(n)}return r}function a(t){var e=[];return t.forEach(function(t){e=e.concat(t.data)}),e=e.sort(function(t,e){return e.radius-t.radius})}function o(t,e,i){var n="<p>"+t+"</p>";return n+="<p>"+e+","+i+"</p>"}function s(){var t={name:"业绩",type:"scatter",data:[],size:5,xAxisIndex:0,yAxisIndex:0,opacity:.6};return t}var l=t.utils,c=t.charts.Chart;t.charts.extend({scatter:i}),l.inherits(i,c),i.prototype.extend=t.extend,i.prototype.extend({init:function(t,e,i,n){var o=this;o.xAxisScale=t.xAxisScale,o.yAxisScale=t.yAxisScale,o.series=r(n,o.xAxisScale,o.yAxisScale),o.data=a(o.series)},render:function(t,e){var i=this;i.mobileMode&&(e=0);var n=i.main.selectAll(".xc-scatter-group").data([1]);n=n.enter().append("g").attr("class","xc-scatter-group").merge(n);var r=n.selectAll(".xc-scatter-item").data(i.data),a="r "+e+"ms linear,cx "+e+"ms linear,cy "+e+"ms linear";r=r.enter().append("circle").merge(r),r.exit().remove(),r.style("transition",a).attr("cx",function(t){return t._serie.xScale(t.data[0])}).attr("cy",function(t){return t._serie.yScale(t.data[1])}).attr("r",function(t){return 0!=t._serie.show?t.radius:0}).attr("fill",function(t){return i.getColor(t._serie.idx)}).attr("opacity",function(t){return t._serie.opacity}).attr("class",function(t){var e="xc-scatter-item";return e+=" xc-scatter-group-"+t._serie.idx}),i.scatterItem=r},ready:function(){this.__legendReady(),this.__tooltipReady()},__legendReady:function(){var t=this,e=null,i=t.config.animation;t.on("legendMouseenter.scatter",function(i){var r=n(t.series,i);e=t.main.selectAll(".xc-scatter-group-"+r.idx),e.attr("opacity",1)}),t.on("legendMouseleave.scatter",function(t){e.attr("opacity",function(t){return t._serie.opacity})}),this.on("legendClick.scatter",function(e){var n=t.config.series;t.init(t.messageCenter,t.config,t.type,n),t.render(i.animationEase,i.animationTime)})},__tooltipReady:function(){if(this.config.tooltip&&this.config.tooltip.show!==!1&&"axis"!=this.config.tooltip.trigger){var t=this,i=t.messageCenter.components.tooltip,n=i.tooltipConfig.formatter;t.mobileMode?t.mobileReady():(t.scatterItem.on("mouseenter.scatter",function(t){e.select(this).attr("opacity",1);var r=e.event,a=r.layerX||r.offsetX,s=r.layerY||r.offsetY,l=t._serie.formatter||n||o;i.showTooltip(),i.setTooltipHtml(l(t._serie.name,t.data[0],t.data[1])),i.setPosition([a,s])}),t.scatterItem.on("mouseleave.scatter",function(t){e.select(this).attr("opacity",function(t){return t._serie.opacity}),i.hiddenTooltip()}))}}})}(e,t),function(t,e){var i=(t.utils,t.charts),n=i.scatter;n.prototype.extend({mobileReady:function(){}})}(e,t),e});